<!DOCTYPE html>
<html lang="en" data-accent-color="grass" data-content_root="../">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Examples - pyexasol</title><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Encryption" href="encryption.html" /><link rel="prev" title="Best Practices" href="best_practices.html" /><script>
    function setColorMode(t){let e=document.documentElement;e.setAttribute("data-color-mode",t);let a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s=t;"auto"===t&&(s=a?"dark":"light"),"light"===s?(e.classList.remove("dark"),e.classList.add("light")):(e.classList.remove("light"),e.classList.add("dark"))}
    setColorMode(localStorage._theme||"auto");
  </script><link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=397bb51e" />
    <link rel="stylesheet" type="text/css" href="../_static/shibuya.css?v=83eaa723" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link media="print" rel="stylesheet" type="text/css" href="../_static/print.css?v=20ff2c19" />
    
    <meta property="og:type" content="website"/><meta property="og:title" content="Examples"/>
<meta name="twitter:card" content="summary"/>
  </head>
<body><div class="sy-head">
  <div class="sy-head-blur"></div>
  <div class="sy-head-inner sy-container mx-auto">
    <a class="sy-head-brand" href="../index.html">
      <img class="light-logo" src="../_static/light-exasol-logo.svg" alt="pyexasol" height="28" loading="lazy" />
      <img class="dark-logo" src="../_static/dark-exasol-logo.svg" alt="pyexasol" height="28" loading="lazy" />
      <strong>pyexasol</strong>
    </a>
    <div class="sy-head-nav" id="HeadNav">
      <nav class="sy-head-links"></nav>
      <div class="sy-head-extra flex items-center print:hidden"><form class="searchbox flex items-center" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <kbd>/</kbd>
</form><div class="sy-head-socials">
  <a href="https://github.com/exasol/pyexasol" aria-label="GitHub">
    <iconify-icon icon="simple-icons:github"></iconify-icon>
  </a></div></div>
    </div>
    <div class="sy-head-actions flex items-center shrink-0 print:hidden"><button class="js-theme theme-switch flex items-center"
data-aria-auto="Switch to light color mode"
data-aria-light="Switch to dark color mode"
data-aria-dark="Switch to auto color mode">
<i class="i-lucide theme-icon"></i>
</button><button class="md:hidden flex items-center js-menu" aria-label="Menu" type="button" aria-controls="HeadNav" aria-expanded="false">
        <div class="hamburger">
          <span class="hamburger_1"></span>
          <span class="hamburger_2 -translate-x-2"></span>
          <span class="hamburger_3 -translate-x-1"></span>
        </div>
      </button>
    </div>
  </div>
</div>
<div class="sy-page sy-container flex mx-auto">
  <aside id="lside" class="sy-lside md:w-72 md:shrink-0 print:hidden">
    <div class="sy-lside-inner md:sticky">
      <div class="sy-scrollbar p-6">
        <div class="globaltoc" data-expand-depth="0"><ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-person" viewBox="0 0 16 16" aria-hidden="true"><path d="M10.561 8.073a6.005 6.005 0 0 1 3.432 5.142.75.75 0 1 1-1.498.07 4.5 4.5 0 0 0-8.99 0 .75.75 0 0 1-1.498-.07 6.004 6.004 0 0 1 3.431-5.142 3.999 3.999 0 1 1 5.123 0ZM10.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z"></path></svg> User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_guide.html"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-tools" viewBox="0 0 16 16" aria-hidden="true"><path d="M5.433 2.304A4.492 4.492 0 0 0 3.5 6c0 1.598.832 3.002 2.09 3.802.518.328.929.923.902 1.64v.008l-.164 3.337a.75.75 0 1 1-1.498-.073l.163-3.33c.002-.085-.05-.216-.207-.316A5.996 5.996 0 0 1 2 6a5.993 5.993 0 0 1 2.567-4.92 1.482 1.482 0 0 1 1.673-.04c.462.296.76.827.76 1.423v2.82c0 .082.041.16.11.206l.75.51a.25.25 0 0 0 .28 0l.75-.51A.249.249 0 0 0 9 5.282V2.463c0-.596.298-1.127.76-1.423a1.482 1.482 0 0 1 1.673.04A5.993 5.993 0 0 1 14 6a5.996 5.996 0 0 1-2.786 5.068c-.157.1-.209.23-.207.315l.163 3.33a.752.752 0 0 1-1.094.714.75.75 0 0 1-.404-.64l-.164-3.345c-.027-.717.384-1.312.902-1.64A4.495 4.495 0 0 0 12.5 6a4.492 4.492 0 0 0-1.933-3.696c-.024.017-.067.067-.067.16v2.818a1.75 1.75 0 0 1-.767 1.448l-.75.51a1.75 1.75 0 0 1-1.966 0l-.75-.51A1.75 1.75 0 0 1 5.5 5.282V2.463c0-.092-.043-.142-.067-.159Z"></path></svg> Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-cpu" viewBox="0 0 16 16" aria-hidden="true"><path d="M6.5.75V2h3V.75a.75.75 0 0 1 1.5 0V2h1.25c.966 0 1.75.784 1.75 1.75V5h1.25a.75.75 0 0 1 0 1.5H14v3h1.25a.75.75 0 0 1 0 1.5H14v1.25A1.75 1.75 0 0 1 12.25 14H11v1.25a.75.75 0 0 1-1.5 0V14h-3v1.25a.75.75 0 0 1-1.5 0V14H3.75A1.75 1.75 0 0 1 2 12.25V11H.75a.75.75 0 0 1 0-1.5H2v-3H.75a.75.75 0 0 1 0-1.5H2V3.75C2 2.784 2.784 2 3.75 2H5V.75a.75.75 0 0 1 1.5 0Zm5.75 11.75a.25.25 0 0 0 .25-.25v-8.5a.25.25 0 0 0-.25-.25h-8.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25ZM5.75 5h4.5a.75.75 0 0 1 .75.75v4.5a.75.75 0 0 1-.75.75h-4.5a.75.75 0 0 1-.75-.75v-4.5A.75.75 0 0 1 5.75 5Zm.75 4.5h3v-3h-3Z"></path></svg> API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-question" viewBox="0 0 16 16" aria-hidden="true"><path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm8-6.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM6.92 6.085h.001a.749.749 0 1 1-1.342-.67c.169-.339.436-.701.849-.977C6.845 4.16 7.369 4 8 4a2.756 2.756 0 0 1 1.637.525c.503.377.863.965.863 1.725 0 .448-.115.83-.329 1.15-.205.307-.47.513-.692.662-.109.072-.22.138-.313.195l-.006.004a6.24 6.24 0 0 0-.26.16.952.952 0 0 0-.276.245.75.75 0 0 1-1.248-.832c.184-.264.42-.489.692-.661.103-.067.207-.132.313-.195l.007-.004c.1-.061.182-.11.258-.161a.969.969 0 0 0 .277-.245C8.96 6.514 9 6.427 9 6.25a.612.612 0 0 0-.262-.525A1.27 1.27 0 0 0 8 5.5c-.369 0-.595.09-.74.187a1.01 1.01 0 0 0-.34.398ZM9 11a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z"></path></svg> FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changes/changelog.html">Changes</a></li>
</ul>

        </div>
      </div>
    </div>
  </aside>
  <div class="lside-overlay js-menu" role="button" aria-label="Close left sidebar" aria-controls="lside" aria-expanded="false"></div>
  <aside id="rside" class="sy-rside pb-3 w-64 shrink-0 order-last">
    <button class="rside-close js-menu xl:hidden" aria-label="Close Table of Contents" type="button" aria-controls="rside" aria-expanded="false">
      <i class="i-lucide close"></i>
    </button>
    <div class="sy-scrollbar sy-rside-inner px-6 xl:top-16 xl:sticky xl:pl-0 pt-6 pb-4"><div class="localtoc"><h3>On this page</h3><ul>
<li><a class="reference internal" href="#preparation">Preparation</a></li>
<li><a class="reference internal" href="#examples-of-core-functions">Examples of core functions</a><ul>
<li><a class="reference internal" href="#basic">Basic</a></li>
<li><a class="reference internal" href="#fetching-tuples">Fetching Tuples</a></li>
<li><a class="reference internal" href="#fetching-dictionaries">Fetching Dictionaries</a></li>
<li><a class="reference internal" href="#custom-data-type-mapper">Custom Data Type Mapper</a></li>
<li><a class="reference internal" href="#sql-formatting">SQL Formatting</a></li>
<li><a class="reference internal" href="#transaction-management">Transaction Management</a></li>
<li><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li><a class="reference internal" href="#extension-functions">Extension Functions</a></li>
<li><a class="reference internal" href="#abort-query">Abort Query</a></li>
<li><a class="reference internal" href="#context-manager">Context Manager</a></li>
<li><a class="reference internal" href="#insert-multiple-rows">Insert Multiple Rows</a></li>
<li><a class="reference internal" href="#metadata-requests">Metadata Requests</a></li>
<li><a class="reference internal" href="#no-sql-metadata">No-SQL Metadata</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples-of-http-transport">Examples of HTTP transport</a><ul>
<li><a class="reference internal" href="#pandas-dataframe">Pandas DataFrame</a></li>
<li><a class="reference internal" href="#other-methods">Other Methods</a></li>
<li><a class="reference internal" href="#parallel-export">Parallel Export</a></li>
<li><a class="reference internal" href="#parallel-import">Parallel Import</a></li>
<li><a class="reference internal" href="#parallel-export-import">Parallel Export/Import</a></li>
<li><a class="reference internal" href="#http-transport-errors">HTTP Transport Errors</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples-of-misc-functions">Examples of misc functions</a><ul>
<li><a class="reference internal" href="#connection-redundancy">Connection Redundancy</a></li>
<li><a class="reference internal" href="#edge-cases">Edge Cases</a></li>
<li><a class="reference internal" href="#db-api-2-0-compatibility">DB-API 2.0 Compatibility</a></li>
<li><a class="reference internal" href="#ssl-encryption">SSL Encryption</a></li>
<li><a class="reference internal" href="#custom-session-parameters">Custom Session Parameters</a></li>
<li><a class="reference internal" href="#local-config-file">Local Config File</a></li>
<li><a class="reference internal" href="#profiling">Profiling</a></li>
<li><a class="reference internal" href="#snapshot-transactions">Snapshot Transactions</a></li>
<li><a class="reference internal" href="#udf-script-output">UDF Script Output</a></li>
<li><a class="reference internal" href="#class-extension">Class Extension</a></li>
<li><a class="reference internal" href="#quoted-identifiers">Quoted Identifiers</a></li>
<li><a class="reference internal" href="#thread-safety">Thread Safety</a></li>
<li><a class="reference internal" href="#dsn-parsing">DSN Parsing</a></li>
<li><a class="reference internal" href="#http-proxy">HTTP Proxy</a></li>
<li><a class="reference internal" href="#garbage-collection">Garbage Collection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples-of-json-libraries-used-for-fetching">Examples of JSON libraries used for fetching</a><ul>
<li><a class="reference internal" href="#rapidjson">RapidJSON</a></li>
<li><a class="reference internal" href="#ujson">UJSON</a></li>
<li><a class="reference internal" href="#orjson">ORJSON</a></li>
</ul>
</li>
</ul>
</div><div id="ethical-ad-placement" data-ea-publisher="readthedocs"></div></div>
  </aside>
  <div class="rside-overlay js-menu" role="button" aria-label="Close Table of Contents" aria-controls="rside" aria-expanded="false"></div>
  <main class="sy-main w-full max-sm:max-w-full print:pt-6"><div class="sy-breadcrumbs" role="navigation">
  <div class="sy-breadcrumbs-inner flex items-center">
    <div class="md:hidden mr-3">
      <button class="js-menu" aria-label="Menu" type="button" aria-controls="lside" aria-expanded="false">
        <i class="i-lucide menu"></i>
      </button>
    </div>
    <ol class="flex-1" itemscope itemtype="https://schema.org/BreadcrumbList"><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="../index.html"><span itemprop="name">pyexasol</span></a>
        <span>/</span>
        <meta itemprop="position" content="1" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <a itemprop="item" href="index.html"><span itemprop="name"><svg version="1.1" width="1.0em" height="1.0em" class="sd-octicon sd-octicon-person" viewBox="0 0 16 16" aria-hidden="true"><path d="M10.561 8.073a6.005 6.005 0 0 1 3.432 5.142.75.75 0 1 1-1.498.07 4.5 4.5 0 0 0-8.99 0 .75.75 0 0 1-1.498-.07 6.004 6.004 0 0 1 3.431-5.142 3.999 3.999 0 1 1 5.123 0ZM10.5 5a2.5 2.5 0 1 0-5 0 2.5 2.5 0 0 0 5 0Z"></path></svg> User Guide</span></a>
        <span>/</span>
        <meta itemprop="position" content="2" />
      </li><li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
        <strong itemprop="name">Examples</strong>
        <meta itemprop="position" content="3" />
      </li></ol>
    <div class="xl:hidden ml-1">
      <button class="js-menu" aria-label="Show table of contents" type="button" aria-controls="rside"
        aria-expanded="false">
        <i class="i-lucide outdent"></i>
      </button>
    </div>
  </div>
</div><div class="flex flex-col break-words justify-between">
      <div class="min-w-0 max-w-6xl px-6 pb-6 pt-8 xl:px-12">
        <article class="yue" role="main">
          <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h1>
<section id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Link to this heading">¶</a></h2>
<p>Basic preparation steps are required to see examples in action.</p>
<ol class="arabic">
<li><p>Install PyEXASOL with <em>optional dependencies</em>.</p></li>
<li><p>Download <a class="reference external" href="https://github.com/exasol/pyexasol/archive/master.zip">PyEXASOL source code</a> and unzip it.</p></li>
<li><p>Make sure Exasol is installed and dedicated schema for testing is created. You may use free <a class="reference external" href="https://www.exasol.com/portal/display/DOWNLOAD/Free+Trial">Exasol Community Edition</a> for testing purposes.</p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">/examples/</span></code> directory and edit file <code class="docutils literal notranslate"><span class="pre">_config.py</span></code>. Input your Exasol credentials.</p></li>
<li><p>Run script to prepare data set for testing:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">python<span class="w"> </span>examples/a00_prepare.py
</span></pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p>That’s all. Now you may run examples in any order like common python scripts. E.g.:</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span data-line="1">python<span class="w"> </span>examples/a01_basic.py
</span></pre></div>
</div>
</div></blockquote>
</section>
<section id="examples-of-core-functions">
<h2>Examples of core functions<a class="headerlink" href="#examples-of-core-functions" title="Link to this heading">¶</a></h2>
<section id="basic">
<h3>Basic<a class="headerlink" href="#basic" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">minimal code to create connection and run query</span><a class="headerlink" href="#id1" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Open connection, run simple query, close connection</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic connect</span>
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Basic query</span>
</span><span data-line="19"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="20"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="21">
</span><span data-line="22"><span class="c1"># Disconnect</span>
</span><span data-line="23"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="fetching-tuples">
<h3>Fetching Tuples<a class="headerlink" href="#fetching-tuples" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">all methods of fetching result set returning tuples</span><a class="headerlink" href="#id2" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Fetch rows as tuples</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic connect (default mapper)</span>
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Fetch tuples row-by-row as iterator</span>
</span><span data-line="19"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">stmt</span><span class="p">:</span>
</span><span data-line="22">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Fetch tuples row-by-row with fetchone</span>
</span><span data-line="25"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="26">
</span><span data-line="27"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span data-line="28">    <span class="n">row</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span data-line="29">
</span><span data-line="30">    <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="31">        <span class="k">break</span>
</span><span data-line="32">
</span><span data-line="33">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span data-line="34">
</span><span data-line="35"><span class="c1"># Fetch many</span>
</span><span data-line="36"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="37"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span data-line="38"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span data-line="39">
</span><span data-line="40"><span class="c1"># Fetch everything in one go</span>
</span><span data-line="41"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="42"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="43">
</span><span data-line="44"><span class="c1"># Fetch one column as list of values</span>
</span><span data-line="45"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT user_id FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="46"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchcol</span><span class="p">())</span>
</span><span data-line="47">
</span><span data-line="48"><span class="c1"># Fetch single value</span>
</span><span data-line="49"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT count(*) FROM users&quot;</span><span class="p">)</span>
</span><span data-line="50"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchval</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
</section>
<section id="fetching-dictionaries">
<h3>Fetching Dictionaries<a class="headerlink" href="#fetching-dictionaries" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">all methods of fetching result set returning dictionaries</span><a class="headerlink" href="#id3" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Fetch rows as dictionaries</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic connect (default mapper)</span>
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">fetch_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="20"><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22"><span class="c1"># Fetch tuples row-by-row as iterator</span>
</span><span data-line="23"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25"><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">stmt</span><span class="p">:</span>
</span><span data-line="26">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span data-line="27">
</span><span data-line="28">
</span><span data-line="29"><span class="c1"># Fetch tuples row-by-row with fetchone</span>
</span><span data-line="30"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="31">
</span><span data-line="32"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span data-line="33">    <span class="n">row</span> <span class="o">=</span> <span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span data-line="34">
</span><span data-line="35">    <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="36">        <span class="k">break</span>
</span><span data-line="37">
</span><span data-line="38">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40"><span class="c1"># Fetch many</span>
</span><span data-line="41"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="42"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span data-line="43"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span data-line="44">
</span><span data-line="45"><span class="c1"># Fetch everything in one go</span>
</span><span data-line="46"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="47"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="48">
</span><span data-line="49"><span class="c1"># Fetch one column as list of values (same as tuples example!)</span>
</span><span data-line="50"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT user_id FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="51"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchcol</span><span class="p">())</span>
</span><span data-line="52">
</span><span data-line="53"><span class="c1"># Fetch single value (same as tuples example!)</span>
</span><span data-line="54"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT count(*) FROM users&quot;</span><span class="p">)</span>
</span><span data-line="55"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchval</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
</section>
<section id="custom-data-type-mapper">
<h3>Custom Data Type Mapper<a class="headerlink" href="#custom-data-type-mapper" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">apply custom data type mapper for fetching</span><a class="headerlink" href="#id4" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Use custom mapper to get python objects out of Exasol fetch methods</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">DECIMAL(p,0)           -&gt; int</span>
</span><span data-line="5"><span class="sd">DECIMAL(p,s)           -&gt; decimal.Decimal</span>
</span><span data-line="6"><span class="sd">DOUBLE                 -&gt; float</span>
</span><span data-line="7"><span class="sd">DATE                   -&gt; datetime.date</span>
</span><span data-line="8"><span class="sd">TIMESTAMP              -&gt; datetime.datetime</span>
</span><span data-line="9"><span class="sd">BOOLEAN                -&gt; bool</span>
</span><span data-line="10"><span class="sd">VARCHAR                -&gt; str</span>
</span><span data-line="11"><span class="sd">CHAR                   -&gt; str</span>
</span><span data-line="12"><span class="sd">INTERVAL DAY TO SECOND -&gt; datetime.timedelta (ExaTimeDelta)</span>
</span><span data-line="13"><span class="sd">&lt;others&gt;               -&gt; str</span>
</span><span data-line="14"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="15">
</span><span data-line="16"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="17">
</span><span data-line="18"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="19">
</span><span data-line="20"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="21">
</span><span data-line="22"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">180</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Basic connect (custom mapper</span>
</span><span data-line="25"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="26">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="27">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="28">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="29">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="30">    <span class="n">fetch_mapper</span><span class="o">=</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">exasol_mapper</span><span class="p">,</span>
</span><span data-line="31"><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="c1"># Fetch objects</span>
</span><span data-line="34"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="35"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="36">
</span><span data-line="37"><span class="c1"># Test timestamp formats with different amount of decimal places</span>
</span><span data-line="38"><span class="c1"># Please note: Exasol stores timestamps with millisecond precision (3 decimal places)</span>
</span><span data-line="39"><span class="c1"># Lack of precision is not a bug, it&#39;s the documented feature</span>
</span><span data-line="40">
</span><span data-line="41"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
</span><span data-line="42">    <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ALTER SESSION SET NLS_TIMESTAMP_FORMAT=&#39;YYYY-MM-DD HH24:MI:SS.FF</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span data-line="43">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT TIMESTAMP&#39;2018-01-01 03:04:05.123456&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchval</span><span class="p">())</span>
</span><span data-line="44">
</span><span data-line="45"><span class="c1"># Test interval mapping</span>
</span><span data-line="46"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="47">    <span class="s2">&quot;SELECT id, from_ts, to_ts, expected_timedelta, cast(to_ts - from_ts as varchar(100)) as expected_interval, to_ts - from_ts AS ts_diff FROM interval_test&quot;</span>
</span><span data-line="48"><span class="p">)</span>
</span><span data-line="49"><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">():</span>
</span><span data-line="50">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;-------- Interval Test #</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> --------&quot;</span><span class="p">)</span>
</span><span data-line="51">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;              FROM: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="52">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;                TO: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="53">
</span><span data-line="54">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPECTED TIMEDELTA: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="55">    <span class="n">actual_timedelta</span> <span class="o">=</span> <span class="n">printer</span><span class="o">.</span><span class="n">pformat</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
</span><span data-line="56">    <span class="k">if</span> <span class="n">actual_timedelta</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
</span><span data-line="57">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="se">\033</span><span class="s2">[1;32mACTUAL TIMEDELTA: </span><span class="si">{</span><span class="n">actual_timedelta</span><span class="si">}</span><span class="s2"> ✓</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">)</span>
</span><span data-line="58">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="59">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="se">\033</span><span class="s2">[1;31mACTUAL TIMEDELTA: </span><span class="si">{</span><span class="n">actual_timedelta</span><span class="si">}</span><span class="s2"> ✗</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">)</span>
</span><span data-line="60">
</span><span data-line="61">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; EXPECTED INTERVAL: </span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="62">    <span class="n">actual_interval</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">to_interval</span><span class="p">()</span>
</span><span data-line="63">    <span class="k">if</span> <span class="n">actual_interval</span> <span class="o">==</span> <span class="n">row</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
</span><span data-line="64">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="se">\033</span><span class="s2">[1;32mACTUAL INTERVAL: </span><span class="si">{</span><span class="n">actual_interval</span><span class="si">}</span><span class="s2"> ✓</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">)</span>
</span><span data-line="65">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="66">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;   </span><span class="se">\033</span><span class="s2">[1;31mACTUAL INTERVAL: </span><span class="si">{</span><span class="n">actual_interval</span><span class="si">}</span><span class="s2"> ✗</span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="sql-formatting">
<h3>SQL Formatting<a class="headerlink" href="#sql-formatting" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">SQL text formatting</span><a class="headerlink" href="#id5" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Format values and identifiers using query_params and pyexasol formatter</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic connect</span>
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># SQL with formatting</span>
</span><span data-line="19"><span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="20">    <span class="s2">&quot;random_value&quot;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">,</span>
</span><span data-line="21">    <span class="s2">&quot;null_value&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="22">    <span class="s2">&quot;table_name_1&quot;</span><span class="p">:</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span>
</span><span data-line="23">    <span class="s2">&quot;table_name_2&quot;</span><span class="p">:</span> <span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span> <span class="s2">&quot;PAYMENTS&quot;</span><span class="p">),</span>
</span><span data-line="24">    <span class="s2">&quot;user_rating&quot;</span><span class="p">:</span> <span class="s2">&quot;0.5&quot;</span><span class="p">,</span>
</span><span data-line="25">    <span class="s2">&quot;user_score&quot;</span><span class="p">:</span> <span class="mf">1e1</span><span class="p">,</span>
</span><span data-line="26">    <span class="s2">&quot;is_female&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span>
</span><span data-line="27">    <span class="s2">&quot;user_statuses&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ACTIVE&quot;</span><span class="p">,</span> <span class="s2">&quot;PASSIVE&quot;</span><span class="p">,</span> <span class="s2">&quot;SUSPENDED&quot;</span><span class="p">],</span>
</span><span data-line="28">    <span class="s2">&quot;exclude_user_score&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
</span><span data-line="29">    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
</span><span data-line="30"><span class="p">}</span>
</span><span data-line="31">
</span><span data-line="32"><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
</span><span data-line="33"><span class="s2">    SELECT </span><span class="si">{random_value}</span><span class="s2"> AS random_value, </span><span class="si">{null_value}</span><span class="s2"> AS null_value, u.user_id, sum(gross_amt) AS gross_amt</span>
</span><span data-line="34"><span class="s2">    FROM {table_name_1!i} u</span>
</span><span data-line="35"><span class="s2">        JOIN {table_name_2!q} p ON (u.user_id=p.user_id)</span>
</span><span data-line="36"><span class="s2">    WHERE u.user_rating &gt;= {user_rating!d}</span>
</span><span data-line="37"><span class="s2">        AND u.user_score &gt; {user_score!f}</span>
</span><span data-line="38"><span class="s2">        AND u.is_female IS </span><span class="si">{is_female!r}</span>
</span><span data-line="39"><span class="s2">        AND u.status IN (</span><span class="si">{user_statuses}</span><span class="s2">)</span>
</span><span data-line="40"><span class="s2">        AND u.user_rating NOT IN ({exclude_user_score!d})</span>
</span><span data-line="41"><span class="s2">    GROUP BY 1,2,3</span>
</span><span data-line="42"><span class="s2">    ORDER BY 4 DESC</span>
</span><span data-line="43"><span class="s2">    LIMIT {limit!d}</span>
</span><span data-line="44"><span class="s2">&quot;&quot;&quot;</span>
</span><span data-line="45">
</span><span data-line="46"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
</span><span data-line="47"><span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">query</span><span class="p">)</span>
</span><span data-line="48"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
</section>
<section id="transaction-management">
<h3>Transaction Management<a class="headerlink" href="#transaction-management" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">transaction management, autocommit</span><a class="headerlink" href="#id6" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Transactions</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="8">
</span><span data-line="9"><span class="c1"># Connect with autocommit OFF</span>
</span><span data-line="10"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="11">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="12">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="13">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="14">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="15">    <span class="n">autocommit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Another way to change autocommit after connection</span>
</span><span data-line="19"><span class="n">C</span><span class="o">.</span><span class="n">set_autocommit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE users&quot;</span><span class="p">)</span>
</span><span data-line="22"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Truncate affected </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows&quot;</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="n">C</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
</span><span data-line="25"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Truncate was rolled back&quot;</span><span class="p">)</span>
</span><span data-line="26">
</span><span data-line="27"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT count(*) FROM users&quot;</span><span class="p">)</span>
</span><span data-line="28"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Select affected </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchval</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows&quot;</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30"><span class="n">C</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span data-line="31"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Select was committed&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="error-handling">
<h3>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">error handling for basic SQL queries</span><a class="headerlink" href="#id7" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Exceptions for basic queries</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Bad dsn</span>
</span><span data-line="14"><span class="k">try</span><span class="p">:</span>
</span><span data-line="15">    <span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">        <span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;123&quot;</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="17">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="18">        <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="19">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="20">    <span class="p">)</span>
</span><span data-line="21"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="22">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Bad user \ password</span>
</span><span data-line="25"><span class="k">try</span><span class="p">:</span>
</span><span data-line="26">    <span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="27">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="28">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="29">        <span class="n">password</span><span class="o">=</span><span class="s2">&quot;123&quot;</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="30">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="31">    <span class="p">)</span>
</span><span data-line="32"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaAuthError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="33">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="34">
</span><span data-line="35"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="36">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="37">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="38">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="39">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="40">    <span class="n">fetch_size_bytes</span><span class="o">=</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span>
</span><span data-line="41"><span class="p">)</span>
</span><span data-line="42">
</span><span data-line="43"><span class="c1"># Invalid SQL</span>
</span><span data-line="44"><span class="k">try</span><span class="p">:</span>
</span><span data-line="45">    <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="46"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="47"><span class="sd">        SELECT1 *</span>
</span><span data-line="48"><span class="sd">        FROM users </span>
</span><span data-line="49"><span class="sd">        ORDER BY user_id </span>
</span><span data-line="50"><span class="sd">        LIMIT 5</span>
</span><span data-line="51"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="52">    <span class="p">)</span>
</span><span data-line="53"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaQueryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="54">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="55">
</span><span data-line="56">
</span><span data-line="57"><span class="c1"># Valid SQL, but error during execution</span>
</span><span data-line="58"><span class="k">try</span><span class="p">:</span>
</span><span data-line="59">    <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="60"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="61"><span class="sd">        SELECT *</span>
</span><span data-line="62"><span class="sd">        FROM users </span>
</span><span data-line="63"><span class="sd">        WHERE user_name = 10</span>
</span><span data-line="64"><span class="sd">        ORDER BY user_id</span>
</span><span data-line="65"><span class="sd">        LIMIT 5</span>
</span><span data-line="66"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="67">    <span class="p">)</span>
</span><span data-line="68"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaQueryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="69">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="70">
</span><span data-line="71"><span class="c1"># Attempt to read from closed cursor</span>
</span><span data-line="72"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM payments&quot;</span><span class="p">)</span>
</span><span data-line="73"><span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span data-line="74"><span class="n">stmt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="75">
</span><span data-line="76"><span class="k">try</span><span class="p">:</span>
</span><span data-line="77">    <span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span data-line="78"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaRequestError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="79">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="80">
</span><span data-line="81"><span class="c1"># Attempt to fetch query without result set</span>
</span><span data-line="82"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;COMMIT&quot;</span><span class="p">)</span>
</span><span data-line="83">
</span><span data-line="84"><span class="k">try</span><span class="p">:</span>
</span><span data-line="85">    <span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span data-line="86"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaRuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="87">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="88">
</span><span data-line="89"><span class="c1"># Attempt to run SELECT with duplicate column names</span>
</span><span data-line="90"><span class="k">try</span><span class="p">:</span>
</span><span data-line="91">    <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="92"><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="93"><span class="sd">        SELECT 1, 1, 2 AS user_id, 3 AS user_id</span>
</span><span data-line="94"><span class="sd">        FROM dual</span>
</span><span data-line="95"><span class="sd">    &quot;&quot;&quot;</span>
</span><span data-line="96">    <span class="p">)</span>
</span><span data-line="97"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaRuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="98">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="99">
</span><span data-line="100"><span class="c1"># Attempt to run query on closed connection</span>
</span><span data-line="101"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="102">
</span><span data-line="103"><span class="k">try</span><span class="p">:</span>
</span><span data-line="104">    <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT 1&quot;</span><span class="p">)</span>
</span><span data-line="105"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaRuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="106">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="107">
</span><span data-line="108"><span class="c1"># Simulate websocket error during close</span>
</span><span data-line="109"><span class="n">C1</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="110">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="111"><span class="p">)</span>
</span><span data-line="112"><span class="n">C2</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="113">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="114"><span class="p">)</span>
</span><span data-line="115">
</span><span data-line="116"><span class="n">C2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;KILL SESSION </span><span class="si">{</span><span class="n">C1</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="117">
</span><span data-line="118"><span class="k">try</span><span class="p">:</span>
</span><span data-line="119">    <span class="n">C1</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="120"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="121">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="extension-functions">
<h3>Extension Functions<a class="headerlink" href="#extension-functions" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">extension functions to help with common problems outside the scope of the database driver</span><a class="headerlink" href="#id8" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Extension functions</span>
</span><span data-line="3"><span class="sd">Metadata functions are deprecated in favor of new &quot;meta&quot;-functions</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Basic connect</span>
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">lower_ident</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_columns</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="24"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span data-line="25">
</span><span data-line="26"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_columns_sql</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users&quot;</span><span class="p">)</span>
</span><span data-line="27"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_sys_columns</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="30"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span data-line="31">
</span><span data-line="32"><span class="n">tables</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_sys_tables</span><span class="p">()</span>
</span><span data-line="33"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span>
</span><span data-line="34">
</span><span data-line="35"><span class="n">views</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_sys_views</span><span class="p">()</span>
</span><span data-line="36"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">views</span><span class="p">)</span>
</span><span data-line="37">
</span><span data-line="38"><span class="n">schemas</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_sys_schemas</span><span class="p">()</span>
</span><span data-line="39"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">schemas</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41"><span class="n">reserved_words</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_reserved_words</span><span class="p">()</span>
</span><span data-line="42"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">reserved_words</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</span><span data-line="43">
</span><span data-line="44"><span class="n">occupied_space</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_disk_space_usage</span><span class="p">()</span>
</span><span data-line="45"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">occupied_space</span><span class="p">)</span>
</span><span data-line="46">
</span><span data-line="47"><span class="n">pd</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">export_to_pandas_with_dtype</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="48"><span class="n">pd</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span><span data-line="49">
</span><span data-line="50"><span class="n">pd</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">export_to_pandas_with_dtype</span><span class="p">(</span><span class="s2">&quot;payments&quot;</span><span class="p">)</span>
</span><span data-line="51"><span class="n">pd</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="abort-query">
<h3>Abort Query<a class="headerlink" href="#abort-query" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">abort running query from a separate thread</span><a class="headerlink" href="#id9" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Abort long running query from another thread</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">threading</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">time</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="14">
</span><span data-line="15">
</span><span data-line="16"><span class="k">class</span> <span class="nc">QueryThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span><span data-line="17">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
</span><span data-line="18">        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span>
</span><span data-line="19">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span data-line="20">
</span><span data-line="21">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="22">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="23">            <span class="c1"># Run heavy query</span>
</span><span data-line="24">            <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="25">                <span class="s2">&quot;SELECT * FROM users a, users b, users c, payments d&quot;</span>
</span><span data-line="26">            <span class="p">)</span>
</span><span data-line="27">        <span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaQueryAbortError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="28">            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="c1"># Basic connect</span>
</span><span data-line="32"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="33">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="34"><span class="p">)</span>
</span><span data-line="35">
</span><span data-line="36"><span class="c1"># Start query thread</span>
</span><span data-line="37"><span class="n">query_thread</span> <span class="o">=</span> <span class="n">QueryThread</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</span><span data-line="38"><span class="n">query_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="39">
</span><span data-line="40"><span class="c1"># Abort query after 1 second</span>
</span><span data-line="41"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="42"><span class="n">C</span><span class="o">.</span><span class="n">abort_query</span><span class="p">()</span>
</span><span data-line="43">
</span><span data-line="44"><span class="n">query_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="context-manager">
<h3>Context Manager<a class="headerlink" href="#context-manager" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text">use WITH clause for ExaConnection and ExaStatement objects</span><a class="headerlink" href="#id10" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Use context manager (&quot;with&quot; statement) for ExaConnection and ExaStatement objects</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic usage</span>
</span><span data-line="14"><span class="k">with</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span> <span class="k">as</span> <span class="n">C</span><span class="p">:</span>
</span><span data-line="17">    <span class="k">with</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stmt</span><span class="p">:</span>
</span><span data-line="18">        <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="19">
</span><span data-line="20">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">is_closed</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">is_closed</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Exception causes connection and statement to be closed</span>
</span><span data-line="25"><span class="k">try</span><span class="p">:</span>
</span><span data-line="26">    <span class="k">with</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="27">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="28">    <span class="p">)</span> <span class="k">as</span> <span class="n">C</span><span class="p">:</span>
</span><span data-line="29">        <span class="k">with</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM unknown_table LIMIT 5&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">stmt</span><span class="p">:</span>
</span><span data-line="30">            <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="31"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaQueryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="32">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">is_closed</span><span class="p">)</span>
</span><span data-line="35"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">is_closed</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="insert-multiple-rows">
<h3>Insert Multiple Rows<a class="headerlink" href="#insert-multiple-rows" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text">INSERT a small number of rows using prepared statements instead of HTTP transport</span><a class="headerlink" href="#id11" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">INSERT multiple rows using prepared statements</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Insert from list</span>
</span><span data-line="19"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE users_copy&quot;</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="n">all_users</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span data-line="22"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">insert_multi</span><span class="p">(</span><span class="s2">&quot;users_copy&quot;</span><span class="p">,</span> <span class="n">all_users</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INSERTED </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="25">
</span><span data-line="26">
</span><span data-line="27"><span class="c1"># Insert from generator with shuffled order of columns</span>
</span><span data-line="28"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE users_copy&quot;</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="k">def</span> <span class="nf">users_generator</span><span class="p">():</span>
</span><span data-line="32">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">):</span>
</span><span data-line="33">        <span class="k">yield</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;abcabc&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-01-01 01:02:03&quot;</span><span class="p">,</span> <span class="s2">&quot;2019-02-01&quot;</span><span class="p">,</span> <span class="s2">&quot;PENDING&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span data-line="34">
</span><span data-line="35">
</span><span data-line="36"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">insert_multi</span><span class="p">(</span>
</span><span data-line="37">    <span class="s2">&quot;users_copy&quot;</span><span class="p">,</span>
</span><span data-line="38">    <span class="n">users_generator</span><span class="p">(),</span>
</span><span data-line="39">    <span class="n">columns</span><span class="o">=</span><span class="p">[</span>
</span><span data-line="40">        <span class="s2">&quot;user_id&quot;</span><span class="p">,</span>
</span><span data-line="41">        <span class="s2">&quot;user_name&quot;</span><span class="p">,</span>
</span><span data-line="42">        <span class="s2">&quot;last_visit_ts&quot;</span><span class="p">,</span>
</span><span data-line="43">        <span class="s2">&quot;register_dt&quot;</span><span class="p">,</span>
</span><span data-line="44">        <span class="s2">&quot;status&quot;</span><span class="p">,</span>
</span><span data-line="45">        <span class="s2">&quot;is_female&quot;</span><span class="p">,</span>
</span><span data-line="46">    <span class="p">],</span>
</span><span data-line="47"><span class="p">)</span>
</span><span data-line="48">
</span><span data-line="49"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;INSERTED </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">st</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="50">
</span><span data-line="51">
</span><span data-line="52"><span class="c1"># Attempt to insert empty data leads to failure, unlike .import_from_iterable()</span>
</span><span data-line="53"><span class="k">try</span><span class="p">:</span>
</span><span data-line="54">    <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">insert_multi</span><span class="p">(</span><span class="s2">&quot;users_copy&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span data-line="55"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaRuntimeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="56">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="metadata-requests">
<h3>Metadata Requests<a class="headerlink" href="#metadata-requests" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text">lock-free meta data requests</span><a class="headerlink" href="#id12" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Lock-free meta data requests</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Get columns without executing SQL query</span>
</span><span data-line="19"><span class="n">columns</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">sql_columns</span><span class="p">(</span><span class="s2">&quot;SELECT a.*, a.user_id + 1 AS next_user_id FROM users a&quot;</span><span class="p">)</span>
</span><span data-line="20"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22">
</span><span data-line="23"><span class="c1"># Schema exists</span>
</span><span data-line="24"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">schema_exists</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">current_schema</span><span class="p">())</span>
</span><span data-line="25"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schema exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="26">
</span><span data-line="27"><span class="c1"># Schema does not exist</span>
</span><span data-line="28"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">schema_exists</span><span class="p">(</span><span class="s2">&quot;abcabcabc&quot;</span><span class="p">)</span>
</span><span data-line="29"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schema exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="30">
</span><span data-line="31">
</span><span data-line="32"><span class="c1"># Table exists</span>
</span><span data-line="33"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">table_exists</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="34"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="35">
</span><span data-line="36"><span class="c1"># Table exists (with schema name)</span>
</span><span data-line="37"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">table_exists</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">current_schema</span><span class="p">(),</span> <span class="s2">&quot;users&quot;</span><span class="p">))</span>
</span><span data-line="38"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40"><span class="c1"># Table does not exist</span>
</span><span data-line="41"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">table_exists</span><span class="p">(</span><span class="s2">&quot;abcabcabc&quot;</span><span class="p">)</span>
</span><span data-line="42"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="43">
</span><span data-line="44">
</span><span data-line="45"><span class="c1"># View exists</span>
</span><span data-line="46"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">view_exists</span><span class="p">(</span><span class="s2">&quot;users_view&quot;</span><span class="p">)</span>
</span><span data-line="47"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;View exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="48">
</span><span data-line="49"><span class="c1"># View exists (with schema name)</span>
</span><span data-line="50"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">view_exists</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">current_schema</span><span class="p">(),</span> <span class="s2">&quot;users_view&quot;</span><span class="p">))</span>
</span><span data-line="51"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;View exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="52">
</span><span data-line="53"><span class="c1"># View does not exist</span>
</span><span data-line="54"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">view_exists</span><span class="p">(</span><span class="s2">&quot;abcabcabc&quot;</span><span class="p">)</span>
</span><span data-line="55"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;View exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="56">
</span><span data-line="57">
</span><span data-line="58"><span class="c1"># List schemas</span>
</span><span data-line="59"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_schemas</span><span class="p">()</span>
</span><span data-line="60"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="61">
</span><span data-line="62"><span class="c1"># List schemas with filters</span>
</span><span data-line="63"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_schemas</span><span class="p">(</span><span class="n">schema_name_pattern</span><span class="o">=</span><span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">)</span>
</span><span data-line="64"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="65">
</span><span data-line="66">
</span><span data-line="67"><span class="c1"># List tables with filters</span>
</span><span data-line="68"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_tables</span><span class="p">(</span><span class="n">table_schema_pattern</span><span class="o">=</span><span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span> <span class="n">table_name_pattern</span><span class="o">=</span><span class="s2">&quot;USERS%&quot;</span><span class="p">)</span>
</span><span data-line="69"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="70">
</span><span data-line="71">
</span><span data-line="72"><span class="c1"># List views with filters</span>
</span><span data-line="73"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_views</span><span class="p">(</span><span class="n">view_schema_pattern</span><span class="o">=</span><span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span> <span class="n">view_name_pattern</span><span class="o">=</span><span class="s2">&quot;USERS%&quot;</span><span class="p">)</span>
</span><span data-line="74"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="75">
</span><span data-line="76">
</span><span data-line="77"><span class="c1"># List columns with filters</span>
</span><span data-line="78"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_columns</span><span class="p">(</span>
</span><span data-line="79">    <span class="n">column_schema_pattern</span><span class="o">=</span><span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span>
</span><span data-line="80">    <span class="n">column_table_pattern</span><span class="o">=</span><span class="s2">&quot;USERS%&quot;</span><span class="p">,</span>
</span><span data-line="81">    <span class="n">column_object_type_pattern</span><span class="o">=</span><span class="s2">&quot;TABLE&quot;</span><span class="p">,</span>
</span><span data-line="82">    <span class="n">column_name_pattern</span><span class="o">=</span><span class="s2">&quot;%_ID%&quot;</span><span class="p">,</span>
</span><span data-line="83"><span class="p">)</span>
</span><span data-line="84"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="85">
</span><span data-line="86">
</span><span data-line="87"><span class="c1"># List objects with filters</span>
</span><span data-line="88"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_objects</span><span class="p">(</span><span class="n">object_name_pattern</span><span class="o">=</span><span class="s2">&quot;USERS%&quot;</span><span class="p">,</span> <span class="n">object_type_pattern</span><span class="o">=</span><span class="s2">&quot;TABLE&quot;</span><span class="p">)</span>
</span><span data-line="89"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="90">
</span><span data-line="91">
</span><span data-line="92"><span class="c1"># List object sizes with filters</span>
</span><span data-line="93"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_object_sizes</span><span class="p">(</span>
</span><span data-line="94">    <span class="n">object_name_pattern</span><span class="o">=</span><span class="s2">&quot;USERS%&quot;</span><span class="p">,</span> <span class="n">object_type_pattern</span><span class="o">=</span><span class="s2">&quot;TABLE&quot;</span>
</span><span data-line="95"><span class="p">)</span>
</span><span data-line="96"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="97">
</span><span data-line="98">
</span><span data-line="99"><span class="c1"># List indices</span>
</span><span data-line="100"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_indices</span><span class="p">(</span><span class="n">index_schema_pattern</span><span class="o">=</span><span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">)</span>
</span><span data-line="101"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span><span data-line="102">
</span><span data-line="103">
</span><span data-line="104"><span class="c1"># List keywords</span>
</span><span data-line="105"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_sql_keywords</span><span class="p">()</span>
</span><span data-line="106"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="no-sql-metadata">
<h3>No-SQL Metadata<a class="headerlink" href="#no-sql-metadata" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text">no-SQL metadata commands introduced in Exasol v7.0+</span><a class="headerlink" href="#id13" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">No SQL lock-free meta data requests introduced in Exasol 7.0, WebSocket protocol v2</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">sys</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14">
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="17"><span class="p">)</span>
</span><span data-line="18">
</span><span data-line="19"><span class="k">if</span> <span class="n">C</span><span class="o">.</span><span class="n">protocol_version</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">PROTOCOL_V2</span><span class="p">:</span>
</span><span data-line="20">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Actual protocol version is less than 2, skipping meta_nosql checks&quot;</span><span class="p">)</span>
</span><span data-line="21">    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Schema exists</span>
</span><span data-line="25"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">schema_exists</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">current_schema</span><span class="p">())</span>
</span><span data-line="26"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schema exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="27">
</span><span data-line="28"><span class="c1"># Schema does not exist</span>
</span><span data-line="29"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">schema_exists</span><span class="p">(</span><span class="s2">&quot;abcabcabc&quot;</span><span class="p">)</span>
</span><span data-line="30"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Schema exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="31">
</span><span data-line="32">
</span><span data-line="33"><span class="c1"># Table exists</span>
</span><span data-line="34"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">table_exists</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="35"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="c1"># Table exists (with schema name)</span>
</span><span data-line="38"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">table_exists</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">current_schema</span><span class="p">(),</span> <span class="s2">&quot;users&quot;</span><span class="p">))</span>
</span><span data-line="39"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41"><span class="c1"># Table does not exist</span>
</span><span data-line="42"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">table_exists</span><span class="p">(</span><span class="s2">&quot;abcabcabc&quot;</span><span class="p">)</span>
</span><span data-line="43"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="44">
</span><span data-line="45">
</span><span data-line="46"><span class="c1"># View exists</span>
</span><span data-line="47"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">view_exists</span><span class="p">(</span><span class="s2">&quot;users_view&quot;</span><span class="p">)</span>
</span><span data-line="48"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;View exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="49">
</span><span data-line="50"><span class="c1"># View exists (with schema name)</span>
</span><span data-line="51"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">view_exists</span><span class="p">((</span><span class="n">C</span><span class="o">.</span><span class="n">current_schema</span><span class="p">(),</span> <span class="s2">&quot;users_view&quot;</span><span class="p">))</span>
</span><span data-line="52"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;View exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="53">
</span><span data-line="54"><span class="c1"># View does not exist</span>
</span><span data-line="55"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">view_exists</span><span class="p">(</span><span class="s2">&quot;abcabcabc&quot;</span><span class="p">)</span>
</span><span data-line="56"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;View exists: </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="57">
</span><span data-line="58">
</span><span data-line="59"><span class="c1"># List schemas</span>
</span><span data-line="60"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">execute_meta_nosql</span><span class="p">(</span><span class="s2">&quot;getSchemas&quot;</span><span class="p">)</span>
</span><span data-line="61"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="62">
</span><span data-line="63"><span class="c1"># List schemas with filters</span>
</span><span data-line="64"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">execute_meta_nosql</span><span class="p">(</span><span class="s2">&quot;getSchemas&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">})</span>
</span><span data-line="65"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="66">
</span><span data-line="67">
</span><span data-line="68"><span class="c1"># List tables with filters</span>
</span><span data-line="69"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">execute_meta_nosql</span><span class="p">(</span>
</span><span data-line="70">    <span class="s2">&quot;getTables&quot;</span><span class="p">,</span>
</span><span data-line="71">    <span class="p">{</span>
</span><span data-line="72">        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span>
</span><span data-line="73">        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;USERS%&quot;</span><span class="p">,</span>
</span><span data-line="74">        <span class="s2">&quot;tableTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;TABLE&quot;</span><span class="p">],</span>
</span><span data-line="75">    <span class="p">},</span>
</span><span data-line="76"><span class="p">)</span>
</span><span data-line="77"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="78">
</span><span data-line="79">
</span><span data-line="80"><span class="c1"># List views with filters</span>
</span><span data-line="81"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">execute_meta_nosql</span><span class="p">(</span>
</span><span data-line="82">    <span class="s2">&quot;getTables&quot;</span><span class="p">,</span>
</span><span data-line="83">    <span class="p">{</span>
</span><span data-line="84">        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span>
</span><span data-line="85">        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;USERS%&quot;</span><span class="p">,</span>
</span><span data-line="86">        <span class="s2">&quot;tableTypes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;VIEW&quot;</span><span class="p">],</span>
</span><span data-line="87">    <span class="p">},</span>
</span><span data-line="88"><span class="p">)</span>
</span><span data-line="89"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="90">
</span><span data-line="91">
</span><span data-line="92"><span class="c1"># List columns with filters</span>
</span><span data-line="93"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">execute_meta_nosql</span><span class="p">(</span>
</span><span data-line="94">    <span class="s2">&quot;getColumns&quot;</span><span class="p">,</span>
</span><span data-line="95">    <span class="p">{</span>
</span><span data-line="96">        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span>
</span><span data-line="97">        <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;USERS%&quot;</span><span class="p">,</span>
</span><span data-line="98">        <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="s2">&quot;%_ID%&quot;</span><span class="p">,</span>
</span><span data-line="99">    <span class="p">},</span>
</span><span data-line="100"><span class="p">)</span>
</span><span data-line="101"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="102">
</span><span data-line="103">
</span><span data-line="104"><span class="c1"># List keywords</span>
</span><span data-line="105"><span class="n">val</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">list_sql_keywords</span><span class="p">()</span>
</span><span data-line="106"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>
</span><span data-line="107">
</span><span data-line="108">
</span><span data-line="109"><span class="c1"># Exception handling</span>
</span><span data-line="110"><span class="k">try</span><span class="p">:</span>
</span><span data-line="111">    <span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">execute_meta_nosql</span><span class="p">(</span>
</span><span data-line="112">        <span class="s2">&quot;getColumns&quot;</span><span class="p">,</span>
</span><span data-line="113">        <span class="p">{</span>
</span><span data-line="114">            <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="s2">&quot;PYEXASOL%&quot;</span><span class="p">,</span>
</span><span data-line="115">            <span class="s2">&quot;table&quot;</span><span class="p">:</span> <span class="s2">&quot;USERS%&quot;</span><span class="p">,</span>
</span><span data-line="116">            <span class="s2">&quot;column&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;%_ID%&quot;</span><span class="p">],</span>
</span><span data-line="117">        <span class="p">},</span>
</span><span data-line="118">    <span class="p">)</span>
</span><span data-line="119"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaRequestError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="120">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
</section>
<section id="examples-of-http-transport">
<h2>Examples of HTTP transport<a class="headerlink" href="#examples-of-http-transport" title="Link to this heading">¶</a></h2>
<section id="pandas-dataframe">
<h3>Pandas DataFrame<a class="headerlink" href="#pandas-dataframe" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text">IMPORT / EXPORT to and from pandas.DataFrame</span><a class="headerlink" href="#id14" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">HTTP Transport</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">EXPORT and IMPORT from Exasol to Pandas DataFrames</span>
</span><span data-line="5"><span class="sd">Make sure to enable compression for Wifi connections to improve performance</span>
</span><span data-line="6"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="c1"># Connect with compression enabled</span>
</span><span data-line="13"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="14">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="15">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="19"><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE users_copy&quot;</span><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="c1"># Export from Exasol table into pandas.DataFrame</span>
</span><span data-line="24"><span class="n">pd</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_pandas</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="25"><span class="n">pd</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span><span data-line="26">
</span><span data-line="27"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="28"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30"><span class="c1"># Import from pandas DataFrame into Exasol table</span>
</span><span data-line="31"><span class="n">C</span><span class="o">.</span><span class="n">import_from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="34"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="35">
</span><span data-line="36"><span class="c1"># Export from SQL query</span>
</span><span data-line="37"><span class="n">pd</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_pandas</span><span class="p">(</span><span class="s2">&quot;SELECT user_id, user_name FROM users WHERE user_id &gt;= 5000&quot;</span><span class="p">)</span>
</span><span data-line="38"><span class="n">pd</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span><span data-line="39">
</span><span data-line="40"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="41"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="other-methods">
<h3>Other Methods<a class="headerlink" href="#other-methods" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text">other methods of IMPORT / EXPORT</span><a class="headerlink" href="#id15" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">HTTP transport</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">EXPORT and IMPORT from Exasol to and from files / lists, etc.</span>
</span><span data-line="5"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">os</span>
</span><span data-line="8"><span class="kn">import</span> <span class="nn">shutil</span>
</span><span data-line="9"><span class="kn">import</span> <span class="nn">tempfile</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="12">
</span><span data-line="13"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="14">
</span><span data-line="15"><span class="c1"># Connect with compression enabled</span>
</span><span data-line="16"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="17">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="21">    <span class="n">compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="22"><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Prepare empty tables</span>
</span><span data-line="25"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE users_copy&quot;</span><span class="p">)</span>
</span><span data-line="26"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE users_copy_reordered&quot;</span><span class="p">)</span>
</span><span data-line="27"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE payments_copy&quot;</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="c1"># Create temporary file</span>
</span><span data-line="30"><span class="n">file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
</span><span data-line="31">
</span><span data-line="32"><span class="c1"># Export to temporary file</span>
</span><span data-line="33"><span class="n">C</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span>
</span><span data-line="34">    <span class="n">file</span><span class="p">,</span>
</span><span data-line="35">    <span class="s2">&quot;users&quot;</span><span class="p">,</span>
</span><span data-line="36">    <span class="n">export_params</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="37">        <span class="s2">&quot;with_column_names&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="38">        <span class="s2">&quot;comment&quot;</span><span class="p">:</span> <span class="s2">&quot;Exporting users to temp file&quot;</span><span class="p">,</span>
</span><span data-line="39">    <span class="p">},</span>
</span><span data-line="40"><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="43"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="44"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="45"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="46"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="47">
</span><span data-line="48"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="49"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="50">
</span><span data-line="51"><span class="c1"># Import from temporary file</span>
</span><span data-line="52"><span class="n">C</span><span class="o">.</span><span class="n">import_from_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">,</span> <span class="n">import_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;skip&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</span><span data-line="53">
</span><span data-line="54"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="55"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="56">
</span><span data-line="57"><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="58">
</span><span data-line="59"><span class="c1"># Export to list</span>
</span><span data-line="60"><span class="n">users</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_list</span><span class="p">(</span><span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="61"><span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span data-line="62"><span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span data-line="63">
</span><span data-line="64"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="65"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="66">
</span><span data-line="67"><span class="c1"># Import from list (or any other iterable)</span>
</span><span data-line="68"><span class="n">C</span><span class="o">.</span><span class="n">import_from_iterable</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">)</span>
</span><span data-line="69">
</span><span data-line="70"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="71"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="72">
</span><span data-line="73">
</span><span data-line="74"><span class="c1"># Export to custom callback</span>
</span><span data-line="75"><span class="k">def</span> <span class="nf">my_export_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dst</span><span class="p">):</span>
</span><span data-line="76">    <span class="n">lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span data-line="77">
</span><span data-line="78">    <span class="c1"># Save 2 first lines</span>
</span><span data-line="79">    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="80">    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pipe</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="81">
</span><span data-line="82">    <span class="c1"># Dump everything else to /dev/null</span>
</span><span data-line="83">    <span class="n">dev_null</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
</span><span data-line="84">    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dev_null</span><span class="p">)</span>
</span><span data-line="85">    <span class="n">dev_null</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="86">
</span><span data-line="87">    <span class="k">return</span> <span class="n">lines</span>
</span><span data-line="88">
</span><span data-line="89">
</span><span data-line="90"><span class="n">res</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">my_export_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">)</span>
</span><span data-line="91"><span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span data-line="92">
</span><span data-line="93"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="94"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="95">
</span><span data-line="96">
</span><span data-line="97"><span class="c1"># Import from custom callback</span>
</span><span data-line="98"><span class="k">def</span> <span class="nf">my_import_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
</span><span data-line="99">    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">src</span><span class="p">:</span>
</span><span data-line="100">        <span class="n">pipe</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</span><span data-line="101">
</span><span data-line="102">
</span><span data-line="103"><span class="n">C</span><span class="o">.</span><span class="n">import_from_callback</span><span class="p">(</span><span class="n">my_import_callback</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">)</span>
</span><span data-line="104"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="105"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="106">
</span><span data-line="107"><span class="c1"># Export as gzipped file</span>
</span><span data-line="108"><span class="n">file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
</span><span data-line="109">
</span><span data-line="110"><span class="n">C</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span>
</span><span data-line="111">    <span class="n">file</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="n">export_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;with_column_names&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;gz&quot;</span><span class="p">}</span>
</span><span data-line="112"><span class="p">)</span>
</span><span data-line="113">
</span><span data-line="114"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="115"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</span><span data-line="116"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="117">
</span><span data-line="118"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="119"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="120">
</span><span data-line="121"><span class="c1"># Import gzipped file</span>
</span><span data-line="122"><span class="n">C</span><span class="o">.</span><span class="n">import_from_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">,</span> <span class="n">import_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;skip&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;gz&quot;</span><span class="p">})</span>
</span><span data-line="123">
</span><span data-line="124"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="125"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="126">
</span><span data-line="127"><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="128">
</span><span data-line="129">
</span><span data-line="130"><span class="c1"># Custom encoding for IMPORT and EXPORT</span>
</span><span data-line="131"><span class="n">file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
</span><span data-line="132">
</span><span data-line="133"><span class="n">C</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;users&quot;</span><span class="p">,</span> <span class="n">export_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;WINDOWS-1251&quot;</span><span class="p">})</span>
</span><span data-line="134">
</span><span data-line="135"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="136"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="137"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="138">
</span><span data-line="139"><span class="c1"># Import file with custom encoding</span>
</span><span data-line="140"><span class="n">C</span><span class="o">.</span><span class="n">import_from_file</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">,</span> <span class="n">import_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;encoding&quot;</span><span class="p">:</span> <span class="s2">&quot;WINDOWS-1251&quot;</span><span class="p">})</span>
</span><span data-line="141">
</span><span data-line="142"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="143"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="144">
</span><span data-line="145"><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="146">
</span><span data-line="147"><span class="c1"># Custom columns list for EXPORT</span>
</span><span data-line="148"><span class="n">file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
</span><span data-line="149">
</span><span data-line="150"><span class="n">C</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span>
</span><span data-line="151">    <span class="n">file</span><span class="p">,</span>
</span><span data-line="152">    <span class="s2">&quot;users&quot;</span><span class="p">,</span>
</span><span data-line="153">    <span class="n">export_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;register_dt&quot;</span><span class="p">,</span> <span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;user_name&quot;</span><span class="p">]},</span>
</span><span data-line="154"><span class="p">)</span>
</span><span data-line="155">
</span><span data-line="156"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="157"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="158"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="159">
</span><span data-line="160"><span class="c1"># Custom columns list for IMPORT</span>
</span><span data-line="161"><span class="n">C</span><span class="o">.</span><span class="n">import_from_file</span><span class="p">(</span>
</span><span data-line="162">    <span class="n">file</span><span class="p">,</span>
</span><span data-line="163">    <span class="s2">&quot;users_copy_reordered&quot;</span><span class="p">,</span>
</span><span data-line="164">    <span class="n">import_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;columns&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;register_dt&quot;</span><span class="p">,</span> <span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;user_name&quot;</span><span class="p">]},</span>
</span><span data-line="165"><span class="p">)</span>
</span><span data-line="166">
</span><span data-line="167"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="168"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="169">
</span><span data-line="170"><span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="171">
</span><span data-line="172"><span class="c1"># Custom CSV cols formatting</span>
</span><span data-line="173"><span class="n">file</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryFile</span><span class="p">()</span>
</span><span data-line="174">
</span><span data-line="175"><span class="n">C</span><span class="o">.</span><span class="n">export_to_file</span><span class="p">(</span>
</span><span data-line="176">    <span class="n">file</span><span class="p">,</span>
</span><span data-line="177">    <span class="s2">&quot;users&quot;</span><span class="p">,</span>
</span><span data-line="178">    <span class="n">export_params</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="179">        <span class="s2">&quot;csv_cols&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span data-line="180">            <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span data-line="181">            <span class="s2">&quot;2&quot;</span><span class="p">,</span>
</span><span data-line="182">            <span class="s2">&quot;3 FORMAT=&#39;DD-MM-YYYY&#39;&quot;</span><span class="p">,</span>
</span><span data-line="183">            <span class="s2">&quot;4..6&quot;</span><span class="p">,</span>
</span><span data-line="184">            <span class="s2">&quot;7 FORMAT=&#39;999.99999&#39;&quot;</span><span class="p">,</span>
</span><span data-line="185">            <span class="s2">&quot;8&quot;</span><span class="p">,</span>
</span><span data-line="186">        <span class="p">]</span>
</span><span data-line="187">    <span class="p">},</span>
</span><span data-line="188"><span class="p">)</span>
</span><span data-line="189">
</span><span data-line="190"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="191"><span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
</span><span data-line="192"><span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="193">
</span><span data-line="194"><span class="n">C</span><span class="o">.</span><span class="n">import_from_file</span><span class="p">(</span>
</span><span data-line="195">    <span class="n">file</span><span class="p">,</span>
</span><span data-line="196">    <span class="s2">&quot;users_copy&quot;</span><span class="p">,</span>
</span><span data-line="197">    <span class="n">import_params</span><span class="o">=</span><span class="p">{</span>
</span><span data-line="198">        <span class="s2">&quot;csv_cols&quot;</span><span class="p">:</span> <span class="p">[</span>
</span><span data-line="199">            <span class="s2">&quot;1&quot;</span><span class="p">,</span>
</span><span data-line="200">            <span class="s2">&quot;2&quot;</span><span class="p">,</span>
</span><span data-line="201">            <span class="s2">&quot;3 FORMAT=&#39;DD-MM-YYYY&#39;&quot;</span><span class="p">,</span>
</span><span data-line="202">            <span class="s2">&quot;4..6&quot;</span><span class="p">,</span>
</span><span data-line="203">            <span class="s2">&quot;7 FORMAT=&#39;999.99999&#39;&quot;</span><span class="p">,</span>
</span><span data-line="204">            <span class="s2">&quot;8&quot;</span><span class="p">,</span>
</span><span data-line="205">        <span class="p">]</span>
</span><span data-line="206">    <span class="p">},</span>
</span><span data-line="207"><span class="p">)</span>
</span><span data-line="208">
</span><span data-line="209"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="210"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="parallel-export">
<h3>Parallel Export<a class="headerlink" href="#parallel-export" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">multi-process HTTP transport for EXPORT</span><a class="headerlink" href="#id16" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Parallel HTTP transport</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">EXPORT into multiple independent processes running in parallel</span>
</span><span data-line="5"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">multiprocessing</span>
</span><span data-line="8"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="11">
</span><span data-line="12"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="13"><span class="kn">import</span> <span class="nn">pyexasol.callback</span> <span class="k">as</span> <span class="nn">cb</span>
</span><span data-line="14">
</span><span data-line="15"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="16">
</span><span data-line="17">
</span><span data-line="18"><span class="k">class</span> <span class="nc">ExportProc</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">):</span>
</span><span data-line="19">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
</span><span data-line="20">        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>
</span><span data-line="21">        <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pipe</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span data-line="24">
</span><span data-line="25">    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="26">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="27">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="28">
</span><span data-line="29">    <span class="nd">@property</span>
</span><span data-line="30">    <span class="k">def</span> <span class="nf">exa_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="31">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span><span data-line="32">
</span><span data-line="33">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="34">        <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="35">
</span><span data-line="36">        <span class="c1"># Init HTTP transport connection</span>
</span><span data-line="37">        <span class="n">http</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">http_transport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;ipaddr&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">])</span>
</span><span data-line="38">
</span><span data-line="39">        <span class="c1"># Send internal Exasol address to parent process</span>
</span><span data-line="40">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">exa_address</span><span class="p">)</span>
</span><span data-line="41">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="42">
</span><span data-line="43">        <span class="c1"># Read data from HTTP transport to DataFrame</span>
</span><span data-line="44">        <span class="n">pd</span> <span class="o">=</span> <span class="n">http</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">cb</span><span class="o">.</span><span class="n">export_to_pandas</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span data-line="45">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Child process </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> finished, exported rows: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="46">
</span><span data-line="47">
</span><span data-line="48"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span data-line="49">    <span class="n">pool_size</span> <span class="o">=</span> <span class="mi">5</span>
</span><span data-line="50">    <span class="n">pool</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="51">    <span class="n">exa_address_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="52">
</span><span data-line="53">    <span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="54">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="55">    <span class="p">)</span>
</span><span data-line="56">
</span><span data-line="57">    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">C</span><span class="o">.</span><span class="n">get_nodes</span><span class="p">(</span><span class="n">pool_size</span><span class="p">):</span>
</span><span data-line="58">        <span class="n">proc</span> <span class="o">=</span> <span class="n">ExportProc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span data-line="59">        <span class="n">proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="60">
</span><span data-line="61">        <span class="n">pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>
</span><span data-line="62">        <span class="n">exa_address_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">exa_address</span><span class="p">)</span>
</span><span data-line="63">
</span><span data-line="64">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
</span><span data-line="65">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">exa_address_list</span><span class="p">)</span>
</span><span data-line="66">
</span><span data-line="67">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="68">        <span class="n">C</span><span class="o">.</span><span class="n">export_parallel</span><span class="p">(</span>
</span><span data-line="69">            <span class="n">exa_address_list</span><span class="p">,</span>
</span><span data-line="70">            <span class="s2">&quot;SELECT * FROM payments&quot;</span><span class="p">,</span>
</span><span data-line="71">            <span class="n">export_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;with_column_names&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span data-line="72">        <span class="p">)</span>
</span><span data-line="73">    <span class="k">except</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">):</span>
</span><span data-line="74">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="75">            <span class="n">p</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span data-line="76">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="77">        <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="78">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="79">    <span class="k">finally</span><span class="p">:</span>
</span><span data-line="80">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="81">            <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="parallel-import">
<h3>Parallel Import<a class="headerlink" href="#parallel-import" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id17">
<div class="code-block-caption"><span class="caption-text">multi-process HTTP transport for IMPORT</span><a class="headerlink" href="#id17" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Parallel HTTP transport</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">IMPORT from multiple independent processes running in parallel</span>
</span><span data-line="5"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">multiprocessing</span>
</span><span data-line="8"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pandas</span>
</span><span data-line="12">
</span><span data-line="13"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="14"><span class="kn">import</span> <span class="nn">pyexasol.callback</span> <span class="k">as</span> <span class="nn">cb</span>
</span><span data-line="15">
</span><span data-line="16"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18">
</span><span data-line="19"><span class="k">class</span> <span class="nc">ImportProc</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">):</span>
</span><span data-line="20">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
</span><span data-line="21">        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>
</span><span data-line="22">        <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pipe</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span data-line="25">
</span><span data-line="26">    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="27">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="28">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="29">
</span><span data-line="30">    <span class="nd">@property</span>
</span><span data-line="31">    <span class="k">def</span> <span class="nf">exa_address</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="32">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span><span data-line="33">
</span><span data-line="34">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="35">        <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="36">
</span><span data-line="37">        <span class="c1"># Init HTTP transport connection</span>
</span><span data-line="38">        <span class="n">http</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">http_transport</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;ipaddr&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">])</span>
</span><span data-line="39">
</span><span data-line="40">        <span class="c1"># Send internal Exasol address to parent process</span>
</span><span data-line="41">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">exa_address</span><span class="p">)</span>
</span><span data-line="42">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="43">
</span><span data-line="44">        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="45">            <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span> <span class="s2">&quot;shard_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]},</span>
</span><span data-line="46">            <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Foo&quot;</span><span class="p">,</span> <span class="s2">&quot;shard_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]},</span>
</span><span data-line="47">            <span class="p">{</span><span class="s2">&quot;user_id&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Bar&quot;</span><span class="p">,</span> <span class="s2">&quot;shard_id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]},</span>
</span><span data-line="48">        <span class="p">]</span>
</span><span data-line="49">
</span><span data-line="50">        <span class="n">pd</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;user_id&quot;</span><span class="p">,</span> <span class="s2">&quot;user_name&quot;</span><span class="p">,</span> <span class="s2">&quot;shard_id&quot;</span><span class="p">])</span>
</span><span data-line="51">
</span><span data-line="52">        <span class="c1"># Send data from DataFrame to HTTP transport</span>
</span><span data-line="53">        <span class="n">http</span><span class="o">.</span><span class="n">import_from_callback</span><span class="p">(</span><span class="n">cb</span><span class="o">.</span><span class="n">import_from_pandas</span><span class="p">,</span> <span class="n">pd</span><span class="p">)</span>
</span><span data-line="54">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Child process </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> finished, imported rows: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="55">
</span><span data-line="56">
</span><span data-line="57"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span data-line="58">    <span class="n">pool_size</span> <span class="o">=</span> <span class="mi">5</span>
</span><span data-line="59">    <span class="n">pool</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="60">    <span class="n">exa_address_list</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="61">
</span><span data-line="62">    <span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="63">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="64">    <span class="p">)</span>
</span><span data-line="65">
</span><span data-line="66">    <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE parallel_import&quot;</span><span class="p">)</span>
</span><span data-line="67">
</span><span data-line="68">    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">C</span><span class="o">.</span><span class="n">get_nodes</span><span class="p">(</span><span class="n">pool_size</span><span class="p">):</span>
</span><span data-line="69">        <span class="n">proc</span> <span class="o">=</span> <span class="n">ImportProc</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span data-line="70">        <span class="n">proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="71">
</span><span data-line="72">        <span class="n">pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>
</span><span data-line="73">        <span class="n">exa_address_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proc</span><span class="o">.</span><span class="n">exa_address</span><span class="p">)</span>
</span><span data-line="74">
</span><span data-line="75">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
</span><span data-line="76">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">exa_address_list</span><span class="p">)</span>
</span><span data-line="77">
</span><span data-line="78">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="79">        <span class="n">C</span><span class="o">.</span><span class="n">import_parallel</span><span class="p">(</span><span class="n">exa_address_list</span><span class="p">,</span> <span class="s2">&quot;parallel_import&quot;</span><span class="p">)</span>
</span><span data-line="80">    <span class="k">except</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">):</span>
</span><span data-line="81">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="82">            <span class="n">p</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span data-line="83">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="84">        <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="85">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="86">    <span class="k">finally</span><span class="p">:</span>
</span><span data-line="87">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="88">            <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="parallel-export-import">
<h3>Parallel Export/Import<a class="headerlink" href="#parallel-export-import" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">multi-process HTTP transport for EXPORT followed by IMPORT</span><a class="headerlink" href="#id18" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Parallel HTTP transport</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">EXPORT data, process it and IMPORT back to Exasol</span>
</span><span data-line="5"><span class="sd">Do it in multiple independent processes running in parallel</span>
</span><span data-line="6">
</span><span data-line="7"><span class="sd">Compression and encryption are enabled in this example</span>
</span><span data-line="8"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">multiprocessing</span>
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="12">
</span><span data-line="13"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="14">
</span><span data-line="15"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="16"><span class="kn">import</span> <span class="nn">pyexasol.callback</span> <span class="k">as</span> <span class="nn">cb</span>
</span><span data-line="17">
</span><span data-line="18"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="19">
</span><span data-line="20">
</span><span data-line="21"><span class="k">class</span> <span class="nc">ExportProc</span><span class="p">(</span><span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">):</span>
</span><span data-line="22">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">):</span>
</span><span data-line="23">        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="n">node</span>
</span><span data-line="24">        <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pipe</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="25">
</span><span data-line="26">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span data-line="27">
</span><span data-line="28">    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="29">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="30">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="31">
</span><span data-line="32">    <span class="nd">@property</span>
</span><span data-line="33">    <span class="k">def</span> <span class="nf">exa_address_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="34">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
</span><span data-line="35">
</span><span data-line="36">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="37">        <span class="bp">self</span><span class="o">.</span><span class="n">read_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="38">
</span><span data-line="39">        <span class="c1"># Init separate HTTP transport connections for EXPORT and IMPORT</span>
</span><span data-line="40">        <span class="n">http_export</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">http_transport</span><span class="p">(</span>
</span><span data-line="41">            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;ipaddr&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span> <span class="n">compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span>
</span><span data-line="42">        <span class="p">)</span>
</span><span data-line="43">        <span class="n">http_import</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">http_transport</span><span class="p">(</span>
</span><span data-line="44">            <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;ipaddr&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s2">&quot;port&quot;</span><span class="p">],</span> <span class="n">compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span>
</span><span data-line="45">        <span class="p">)</span>
</span><span data-line="46">
</span><span data-line="47">        <span class="c1"># Send pairs of internal Exasol address to parent process</span>
</span><span data-line="48">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">send</span><span class="p">([</span><span class="n">http_export</span><span class="o">.</span><span class="n">exa_address</span><span class="p">,</span> <span class="n">http_import</span><span class="o">.</span><span class="n">exa_address</span><span class="p">])</span>
</span><span data-line="49">        <span class="bp">self</span><span class="o">.</span><span class="n">write_pipe</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="50">
</span><span data-line="51">        <span class="c1"># Read data from HTTP transport to DataFrame</span>
</span><span data-line="52">        <span class="n">pd</span> <span class="o">=</span> <span class="n">http_export</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">cb</span><span class="o">.</span><span class="n">export_to_pandas</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span><span data-line="53">        <span class="nb">print</span><span class="p">(</span>
</span><span data-line="54">            <span class="sa">f</span><span class="s2">&quot;EXPORT child process </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> finished, exported rows:</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="55">        <span class="p">)</span>
</span><span data-line="56">
</span><span data-line="57">        <span class="c1"># Modify data set</span>
</span><span data-line="58">        <span class="n">pd</span><span class="p">[</span><span class="s2">&quot;GROSS_AMT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">[</span><span class="s2">&quot;GROSS_AMT&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</span><span data-line="59">
</span><span data-line="60">        <span class="c1"># Write data back to HTTP transport</span>
</span><span data-line="61">        <span class="n">http_import</span><span class="o">.</span><span class="n">import_from_callback</span><span class="p">(</span><span class="n">cb</span><span class="o">.</span><span class="n">import_from_pandas</span><span class="p">,</span> <span class="n">pd</span><span class="p">)</span>
</span><span data-line="62">        <span class="nb">print</span><span class="p">(</span>
</span><span data-line="63">            <span class="sa">f</span><span class="s2">&quot;IMPORT child process </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">node</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> finished, imported rows:</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">pd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="64">        <span class="p">)</span>
</span><span data-line="65">
</span><span data-line="66">
</span><span data-line="67"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
</span><span data-line="68">    <span class="n">pool_size</span> <span class="o">=</span> <span class="mi">8</span>
</span><span data-line="69">    <span class="n">pool</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="70">    <span class="n">exa_address_export</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="71">    <span class="n">exa_address_import</span> <span class="o">=</span> <span class="p">[]</span>
</span><span data-line="72">
</span><span data-line="73">    <span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="74">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="75">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="76">        <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="77">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="78">        <span class="n">compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="79">        <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="80">    <span class="p">)</span>
</span><span data-line="81">
</span><span data-line="82">    <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE payments_copy&quot;</span><span class="p">)</span>
</span><span data-line="83">
</span><span data-line="84">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">C</span><span class="o">.</span><span class="n">get_nodes</span><span class="p">(</span><span class="n">pool_size</span><span class="p">):</span>
</span><span data-line="85">        <span class="n">proc</span> <span class="o">=</span> <span class="n">ExportProc</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span><span data-line="86">        <span class="n">proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="87">
</span><span data-line="88">        <span class="n">pool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>
</span><span data-line="89">        <span class="n">pair</span> <span class="o">=</span> <span class="n">proc</span><span class="o">.</span><span class="n">exa_address_pair</span>
</span><span data-line="90">
</span><span data-line="91">        <span class="n">exa_address_export</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span data-line="92">        <span class="n">exa_address_import</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span data-line="93">
</span><span data-line="94">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">pool</span><span class="p">)</span>
</span><span data-line="95">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">exa_address_export</span><span class="p">)</span>
</span><span data-line="96">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">exa_address_import</span><span class="p">)</span>
</span><span data-line="97">
</span><span data-line="98">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="99">        <span class="n">C</span><span class="o">.</span><span class="n">export_parallel</span><span class="p">(</span>
</span><span data-line="100">            <span class="n">exa_address_export</span><span class="p">,</span>
</span><span data-line="101">            <span class="s2">&quot;SELECT * FROM payments&quot;</span><span class="p">,</span>
</span><span data-line="102">            <span class="n">export_params</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;with_column_names&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
</span><span data-line="103">        <span class="p">)</span>
</span><span data-line="104">    <span class="k">except</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">):</span>
</span><span data-line="105">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="106">            <span class="n">p</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span data-line="107">            <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span data-line="108">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="109">        <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="110">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="111">
</span><span data-line="112">    <span class="k">try</span><span class="p">:</span>
</span><span data-line="113">        <span class="n">C</span><span class="o">.</span><span class="n">import_parallel</span><span class="p">(</span><span class="n">exa_address_import</span><span class="p">,</span> <span class="s2">&quot;payments_copy&quot;</span><span class="p">)</span>
</span><span data-line="114">    <span class="k">except</span> <span class="p">(</span><span class="ne">Exception</span><span class="p">,</span> <span class="ne">KeyboardInterrupt</span><span class="p">):</span>
</span><span data-line="115">        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="116">            <span class="n">p</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span data-line="117">            <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span data-line="118">    <span class="k">else</span><span class="p">:</span>
</span><span data-line="119">        <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="120">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="121">
</span><span data-line="122">    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pool</span><span class="p">:</span>
</span><span data-line="123">        <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="http-transport-errors">
<h3>HTTP Transport Errors<a class="headerlink" href="#http-transport-errors" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">various ways to break HTTP transport and handle errors</span><a class="headerlink" href="#id19" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Parallel HTTP transport</span>
</span><span data-line="3">
</span><span data-line="4"><span class="sd">Edge cases, killing &amp; failing various components at different times</span>
</span><span data-line="5"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">os</span>
</span><span data-line="8"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="9"><span class="kn">import</span> <span class="nn">shutil</span>
</span><span data-line="10"><span class="kn">import</span> <span class="nn">threading</span>
</span><span data-line="11"><span class="kn">import</span> <span class="nn">time</span>
</span><span data-line="12"><span class="kn">import</span> <span class="nn">traceback</span>
</span><span data-line="13">
</span><span data-line="14"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="15">
</span><span data-line="16"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="17">
</span><span data-line="18"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="19">
</span><span data-line="20"><span class="n">dev_null</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">devnull</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22">
</span><span data-line="23"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="24">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="25">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="26">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="27">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="28">    <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="29"><span class="p">)</span>
</span><span data-line="30">
</span><span data-line="31">
</span><span data-line="32"><span class="c1">###</span>
</span><span data-line="33"><span class="c1"># Normal execution</span>
</span><span data-line="34"><span class="c1">###</span>
</span><span data-line="35">
</span><span data-line="36">
</span><span data-line="37"><span class="k">def</span> <span class="nf">observer_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span data-line="38">    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Threads running: </span><span class="si">{</span><span class="n">threading</span><span class="o">.</span><span class="n">active_count</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="39">    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dev_null</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41">    <span class="k">return</span>
</span><span data-line="42">
</span><span data-line="43">
</span><span data-line="44"><span class="n">C</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">observer_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM users LIMIT 1000&quot;</span><span class="p">)</span>
</span><span data-line="45"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Finished Observer callback (normal execution) ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="46">
</span><span data-line="47">
</span><span data-line="48"><span class="c1">###</span>
</span><span data-line="49"><span class="c1"># SQL error</span>
</span><span data-line="50"><span class="c1">###</span>
</span><span data-line="51">
</span><span data-line="52">
</span><span data-line="53"><span class="k">try</span><span class="p">:</span>
</span><span data-line="54">    <span class="n">C</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">observer_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM usersaaa LIMIT 1000&quot;</span><span class="p">)</span>
</span><span data-line="55"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="56">    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</span><span data-line="57">
</span><span data-line="58"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Finished Observer callback (SQL error) ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="59">
</span><span data-line="60">
</span><span data-line="61"><span class="c1">###</span>
</span><span data-line="62"><span class="c1"># Abort SQL query</span>
</span><span data-line="63"><span class="c1">###</span>
</span><span data-line="64">
</span><span data-line="65">
</span><span data-line="66"><span class="k">def</span> <span class="nf">abort_query_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span data-line="67">    <span class="n">C</span><span class="o">.</span><span class="n">abort_query</span><span class="p">()</span>
</span><span data-line="68">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span><span data-line="69">
</span><span data-line="70">    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dev_null</span><span class="p">)</span>
</span><span data-line="71">
</span><span data-line="72">    <span class="k">return</span>
</span><span data-line="73">
</span><span data-line="74">
</span><span data-line="75"><span class="k">try</span><span class="p">:</span>
</span><span data-line="76">    <span class="n">C</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">abort_query_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM users LIMIT 1000&quot;</span><span class="p">)</span>
</span><span data-line="77"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="78">    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</span><span data-line="79">
</span><span data-line="80"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Finished Abort Query ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="81">
</span><span data-line="82">
</span><span data-line="83"><span class="c1">###</span>
</span><span data-line="84"><span class="c1"># Error from callback EXPORT</span>
</span><span data-line="85"><span class="c1">###</span>
</span><span data-line="86">
</span><span data-line="87">
</span><span data-line="88"><span class="k">def</span> <span class="nf">runtime_error_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span data-line="89">    <span class="n">pipe</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span data-line="90">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="91">
</span><span data-line="92">    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Test error!&quot;</span><span class="p">)</span>
</span><span data-line="93">
</span><span data-line="94">
</span><span data-line="95"><span class="k">try</span><span class="p">:</span>
</span><span data-line="96">    <span class="n">C</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span><span class="n">runtime_error_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM users LIMIT 1000&quot;</span><span class="p">)</span>
</span><span data-line="97"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="98">    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</span><span data-line="99">
</span><span data-line="100"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Finished Runtime Error EXPORT Callback ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="101">
</span><span data-line="102">
</span><span data-line="103"><span class="c1">###</span>
</span><span data-line="104"><span class="c1"># Error from callback IMPORT</span>
</span><span data-line="105"><span class="c1">###</span>
</span><span data-line="106">
</span><span data-line="107">
</span><span data-line="108"><span class="k">def</span> <span class="nf">runtime_error_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span data-line="109">    <span class="n">pipe</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;a,b,c,d&quot;</span><span class="p">)</span>
</span><span data-line="110">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="111">
</span><span data-line="112">    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Test error!&quot;</span><span class="p">)</span>
</span><span data-line="113">
</span><span data-line="114">
</span><span data-line="115"><span class="k">try</span><span class="p">:</span>
</span><span data-line="116">    <span class="n">C</span><span class="o">.</span><span class="n">import_from_callback</span><span class="p">(</span><span class="n">runtime_error_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">)</span>
</span><span data-line="117"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="118">    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</span><span data-line="119">
</span><span data-line="120"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Finished Runtime Error IMPORT Callback ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="121">
</span><span data-line="122">
</span><span data-line="123"><span class="c1">###</span>
</span><span data-line="124"><span class="c1"># Close WS connection</span>
</span><span data-line="125"><span class="c1">###</span>
</span><span data-line="126">
</span><span data-line="127">
</span><span data-line="128"><span class="k">def</span> <span class="nf">close_connection_callback</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span data-line="129">    <span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">disconnect</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="130">    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="131">
</span><span data-line="132">    <span class="n">shutil</span><span class="o">.</span><span class="n">copyfileobj</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span> <span class="n">dev_null</span><span class="p">)</span>
</span><span data-line="133">
</span><span data-line="134">    <span class="k">return</span>
</span><span data-line="135">
</span><span data-line="136">
</span><span data-line="137"><span class="k">try</span><span class="p">:</span>
</span><span data-line="138">    <span class="n">C</span><span class="o">.</span><span class="n">export_to_callback</span><span class="p">(</span>
</span><span data-line="139">        <span class="n">close_connection_callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;SELECT * FROM users LIMIT 1000&quot;</span>
</span><span data-line="140">    <span class="p">)</span>
</span><span data-line="141"><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="142">    <span class="n">traceback</span><span class="o">.</span><span class="n">print_exc</span><span class="p">()</span>
</span><span data-line="143">
</span><span data-line="144"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;--- Finished Close Connection ---</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
</section>
<section id="examples-of-misc-functions">
<h2>Examples of misc functions<a class="headerlink" href="#examples-of-misc-functions" title="Link to this heading">¶</a></h2>
<section id="connection-redundancy">
<h3>Connection Redundancy<a class="headerlink" href="#connection-redundancy" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">connection redundancy, handling of missing nodes</span><a class="headerlink" href="#id20" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Connection redundancy, attempts to connect to all hosts from DSN in random order</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic connect</span>
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="s2">&quot;0.42.42.40..49,&quot;</span> <span class="o">+</span> <span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">connection_timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="edge-cases">
<h3>Edge Cases<a class="headerlink" href="#edge-cases" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">storing and fetching biggest and smallest values for data types available in Exasol</span><a class="headerlink" href="#id21" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Try to read and write minimum and maximum possible values, test various edge cases</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">decimal</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Basic connect</span>
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="17"><span class="p">)</span>
</span><span data-line="18">
</span><span data-line="19"><span class="n">edge_cases</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="20">    <span class="c1"># Biggest values</span>
</span><span data-line="21">    <span class="p">{</span>
</span><span data-line="22">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="23">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="24">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="25">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="26">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31&quot;</span><span class="p">,</span>
</span><span data-line="27">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31 23:59:59.999&quot;</span><span class="p">,</span>
</span><span data-line="28">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="29">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">2000000</span><span class="p">,</span>
</span><span data-line="30">    <span class="p">},</span>
</span><span data-line="31">    <span class="c1"># Smallest values</span>
</span><span data-line="32">    <span class="p">{</span>
</span><span data-line="33">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="34">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="35">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="36">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="37">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01&quot;</span><span class="p">,</span>
</span><span data-line="38">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01 00:00:00&quot;</span><span class="p">,</span>
</span><span data-line="39">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span data-line="40">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span><span class="p">,</span>
</span><span data-line="41">    <span class="p">},</span>
</span><span data-line="42">    <span class="c1"># All nulls</span>
</span><span data-line="43">    <span class="p">{</span>
</span><span data-line="44">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="45">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="46">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="47">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="48">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="49">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="50">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="51">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="52">    <span class="p">},</span>
</span><span data-line="53"><span class="p">]</span>
</span><span data-line="54">
</span><span data-line="55"><span class="n">insert_q</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO edge_case VALUES ({dec36_0!d}, {dec36_36!d}, {dbl!f}, </span><span class="si">{bl}</span><span class="s2">, </span><span class="si">{dt}</span><span class="s2">, </span><span class="si">{ts}</span><span class="s2">, </span><span class="si">{var100}</span><span class="s2">, </span><span class="si">{var2000000}</span><span class="s2">)&quot;</span>
</span><span data-line="56"><span class="n">select_q</span> <span class="o">=</span> <span class="s2">&quot;SELECT dec36_0, dec36_36, dbl, bl, dt, ts, var100, LENGTH(var2000000) AS len_var FROM edge_case&quot;</span>
</span><span data-line="57">
</span><span data-line="58"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="59">
</span><span data-line="60"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="61"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="62"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="63"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="64">
</span><span data-line="65"><span class="c1"># Select and fetch</span>
</span><span data-line="66"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="67"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="68">
</span><span data-line="69">
</span><span data-line="70"><span class="c1"># Same actions with &quot;exasol_mapper&quot;</span>
</span><span data-line="71"><span class="n">C</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;fetch_mapper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">exasol_mapper</span>
</span><span data-line="72"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="73">
</span><span data-line="74"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="75"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="76"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="77"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="78">
</span><span data-line="79"><span class="c1"># Select and fetch</span>
</span><span data-line="80"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="81"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="82">
</span><span data-line="83"><span class="c1"># Import and export</span>
</span><span data-line="84"><span class="n">edge_tuples</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM edge_case&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span><span data-line="85">
</span><span data-line="86"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="87">
</span><span data-line="88"><span class="n">C</span><span class="o">.</span><span class="n">import_from_iterable</span><span class="p">(</span><span class="n">edge_tuples</span><span class="p">,</span> <span class="s2">&quot;edge_case&quot;</span><span class="p">)</span>
</span><span data-line="89"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="90"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="91">
</span><span data-line="92"><span class="n">res</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_list</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="93"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="94"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="95"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span data-line="96">
</span><span data-line="97"><span class="c1"># resultSetHandle and data in the same response</span>
</span><span data-line="98"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT a.* FROM edge_case a, edge_case b, edge_case c, edge_case d&quot;</span><span class="p">)</span>
</span><span data-line="99"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows total: </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">num_rows_total</span><span class="si">}</span><span class="s2">, rows chunk: </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">num_rows_chunk</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="100"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows actually returned </span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">stmt</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="101">
</span><span data-line="102">
</span><span data-line="103"><span class="c1"># Very large query</span>
</span><span data-line="104"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="105">    <span class="s2">&quot;SELECT </span><span class="si">{val1}</span><span class="s2"> AS val1, </span><span class="si">{val2}</span><span class="s2"> AS val2, </span><span class="si">{val3}</span><span class="s2"> AS val3, </span><span class="si">{val4}</span><span class="s2"> AS val4, </span><span class="si">{val5}</span><span class="s2"> AS val5&quot;</span><span class="p">,</span>
</span><span data-line="106">    <span class="p">{</span>
</span><span data-line="107">        <span class="s2">&quot;val1&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="108">        <span class="s2">&quot;val2&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="109">        <span class="s2">&quot;val3&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="110">        <span class="s2">&quot;val4&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="111">        <span class="s2">&quot;val5&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="112">    <span class="p">},</span>
</span><span data-line="113"><span class="p">)</span>
</span><span data-line="114">
</span><span data-line="115"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="116"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result column length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="117">
</span><span data-line="118"><span class="c1"># Very large query with compression</span>
</span><span data-line="119"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="120">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="121">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="122">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="123">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="124">    <span class="n">compression</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="125">    <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="126"><span class="p">)</span>
</span><span data-line="127">
</span><span data-line="128"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="129">    <span class="s2">&quot;SELECT </span><span class="si">{val1}</span><span class="s2"> AS val1, </span><span class="si">{val2}</span><span class="s2"> AS val2, </span><span class="si">{val3}</span><span class="s2"> AS val3, </span><span class="si">{val4}</span><span class="s2"> AS val4, </span><span class="si">{val5}</span><span class="s2"> AS val5&quot;</span><span class="p">,</span>
</span><span data-line="130">    <span class="p">{</span>
</span><span data-line="131">        <span class="s2">&quot;val1&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="132">        <span class="s2">&quot;val2&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="133">        <span class="s2">&quot;val3&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="134">        <span class="s2">&quot;val4&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="135">        <span class="s2">&quot;val5&quot;</span><span class="p">:</span> <span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;var2000000&quot;</span><span class="p">],</span>
</span><span data-line="136">    <span class="p">},</span>
</span><span data-line="137"><span class="p">)</span>
</span><span data-line="138">
</span><span data-line="139"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Query length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">query</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="140"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result column length: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="db-api-2-0-compatibility">
<h3>DB-API 2.0 Compatibility<a class="headerlink" href="#db-api-2-0-compatibility" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text">DB-API 2.0 compatibility wrapper</span><a class="headerlink" href="#id22" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Basic compatibility with DB-API 2.0</span>
</span><span data-line="3"><span class="sd">Suitable for temporary testing only, should not be used in production</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol.db2</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">db2</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17"><span class="n">cur</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
</span><span data-line="18">
</span><span data-line="19"><span class="c1"># Fetch tuples row-by-row as iterator</span>
</span><span data-line="20"><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22"><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span data-line="23">    <span class="n">row</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</span><span data-line="24">
</span><span data-line="25">    <span class="k">if</span> <span class="n">row</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span data-line="26">        <span class="k">break</span>
</span><span data-line="27">
</span><span data-line="28">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30"><span class="c1"># Fetch many</span>
</span><span data-line="31"><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="32"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span data-line="33"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</span><span data-line="34">
</span><span data-line="35"><span class="c1"># Fetch everything in one go</span>
</span><span data-line="36"><span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="37"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="38">
</span><span data-line="39"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">description</span><span class="p">)</span>
</span><span data-line="40"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cur</span><span class="o">.</span><span class="n">rowcount</span><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42"><span class="c1"># Autocommit is False by default</span>
</span><span data-line="43"><span class="nb">print</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">attr</span><span class="p">[</span><span class="s2">&quot;autocommit&quot;</span><span class="p">])</span>
</span><span data-line="44"><span class="n">C</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="ssl-encryption">
<h3>SSL Encryption<a class="headerlink" href="#ssl-encryption" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text">SSL-encrypted WebSocket connection and HTTP transport</span><a class="headerlink" href="#id23" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Connection with SSL encryption enabled</span>
</span><span data-line="3"><span class="sd">It works both for WebSocket communication (wss://) and HTTP(S) Transport</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">import</span> <span class="nn">hashlib</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="14">
</span><span data-line="15"><span class="c1"># Connect with encryption</span>
</span><span data-line="16"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="17">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="21">    <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="22"><span class="p">)</span>
</span><span data-line="23">
</span><span data-line="24"><span class="c1"># Basic query</span>
</span><span data-line="25"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="26"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="27">
</span><span data-line="28"><span class="c1"># Export to list</span>
</span><span data-line="29"><span class="n">users</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_list</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="30"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="31"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="32">
</span><span data-line="33"><span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span data-line="34"><span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span data-line="35">
</span><span data-line="36"><span class="c1"># Import from list</span>
</span><span data-line="37"><span class="n">C</span><span class="o">.</span><span class="n">import_from_iterable</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="s2">&quot;users_copy&quot;</span><span class="p">)</span>
</span><span data-line="38"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="39"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41">
</span><span data-line="42"><span class="c1"># Connect with encryption AND certificate fingerprint check</span>
</span><span data-line="43"><span class="n">server_fingerprint</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">_ws</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">getpeercert</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
</span><span data-line="44"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server certificate fingerprint: </span><span class="si">{</span><span class="n">server_fingerprint</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="45">
</span><span data-line="46"><span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">:</span>
</span><span data-line="47">    <span class="n">dsn_with_valid_fingerprint</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">server_fingerprint</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
</span><span data-line="48">    <span class="n">dsn_with_invalid_fingerprint</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;/123abc:&quot;</span><span class="p">)</span>
</span><span data-line="49"><span class="k">else</span><span class="p">:</span>
</span><span data-line="50">    <span class="n">dsn_with_valid_fingerprint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">server_fingerprint</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span data-line="51">    <span class="n">dsn_with_invalid_fingerprint</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="si">}</span><span class="s2">/123abc&quot;</span>
</span><span data-line="52">
</span><span data-line="53"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="54">    <span class="n">dsn</span><span class="o">=</span><span class="n">dsn_with_valid_fingerprint</span><span class="p">,</span>
</span><span data-line="55">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="56">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="57">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="58">    <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="59"><span class="p">)</span>
</span><span data-line="60"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Encrypted connection with fingerprint validation was established&quot;</span><span class="p">)</span>
</span><span data-line="61">
</span><span data-line="62">
</span><span data-line="63"><span class="c1"># Invalid fingerprint causes exception</span>
</span><span data-line="64"><span class="k">try</span><span class="p">:</span>
</span><span data-line="65">    <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="66">        <span class="n">dsn</span><span class="o">=</span><span class="n">dsn_with_invalid_fingerprint</span><span class="p">,</span>
</span><span data-line="67">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="68">        <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="69">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="70">        <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="71">    <span class="p">)</span>
</span><span data-line="72"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionFailedError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="73">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="74">
</span><span data-line="75"><span class="c1"># Valid fingerprint without encryption causes exception</span>
</span><span data-line="76"><span class="k">try</span><span class="p">:</span>
</span><span data-line="77">    <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="78">        <span class="n">dsn</span><span class="o">=</span><span class="n">dsn_with_valid_fingerprint</span><span class="p">,</span>
</span><span data-line="79">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="80">        <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="81">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="82">    <span class="p">)</span>
</span><span data-line="83"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionDsnError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="84">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="custom-session-parameters">
<h3>Custom Session Parameters<a class="headerlink" href="#custom-session-parameters" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text">passing custom session parameters client_name, client_version, etc.</span><a class="headerlink" href="#id24" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Custom client name, client version, other session parameters</span>
</span><span data-line="3"><span class="sd">Useful for logging</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Normal session</span>
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">fetch_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM EXA_DBA_SESSIONS WHERE session_id=CURRENT_SESSION&quot;</span><span class="p">)</span>
</span><span data-line="24"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="25">
</span><span data-line="26"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="27">
</span><span data-line="28"><span class="c1"># Modified session</span>
</span><span data-line="29"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="30">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="31">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="32">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="33">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="34">    <span class="n">fetch_dict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="35">    <span class="n">client_name</span><span class="o">=</span><span class="s2">&quot;MyCustomClient&quot;</span><span class="p">,</span>
</span><span data-line="36">    <span class="n">client_version</span><span class="o">=</span><span class="s2">&quot;1.2.3&quot;</span><span class="p">,</span>
</span><span data-line="37">    <span class="n">client_os_username</span><span class="o">=</span><span class="s2">&quot;small_cat&quot;</span><span class="p">,</span>
</span><span data-line="38"><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40"><span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM EXA_DBA_SESSIONS WHERE session_id=CURRENT_SESSION&quot;</span><span class="p">)</span>
</span><span data-line="41"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="42">
</span><span data-line="43"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="local-config-file">
<h3>Local Config File<a class="headerlink" href="#local-config-file" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-text">connect using local config file</span><a class="headerlink" href="#id25" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Local config file</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">configparser</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pathlib</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="8"><span class="kn">import</span> <span class="nn">tempfile</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="11">
</span><span data-line="12"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="13">
</span><span data-line="14"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="15">
</span><span data-line="16"><span class="c1"># Generate tmp file with sample config</span>
</span><span data-line="17"><span class="k">with</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tempdir</span><span class="p">:</span>
</span><span data-line="18">    <span class="n">tempdir</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">tempdir</span><span class="p">)</span>
</span><span data-line="19">
</span><span data-line="20">    <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">tempdir</span> <span class="o">/</span> <span class="s2">&quot;test.ini&quot;</span><span class="p">,</span> <span class="s2">&quot;w+&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</span><span data-line="21">    <span class="n">parser</span> <span class="o">=</span> <span class="n">configparser</span><span class="o">.</span><span class="n">ConfigParser</span><span class="p">()</span>
</span><span data-line="22">
</span><span data-line="23">    <span class="n">parser</span><span class="p">[</span><span class="s2">&quot;test1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span data-line="24">        <span class="s2">&quot;dsn&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="25">        <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="26">        <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="27">        <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="28">        <span class="s2">&quot;compression&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="29">        <span class="s2">&quot;encryption&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="30">        <span class="s2">&quot;socket_timeout&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
</span><span data-line="31">    <span class="p">}</span>
</span><span data-line="32">
</span><span data-line="33">    <span class="n">parser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>
</span><span data-line="34">    <span class="n">handle</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span data-line="35">
</span><span data-line="36">    <span class="nb">print</span><span class="p">(</span><span class="n">handle</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span><span data-line="37">    <span class="n">handle</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="38">
</span><span data-line="39">    <span class="c1"># Open connection using config file</span>
</span><span data-line="40">    <span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect_local_config</span><span class="p">(</span><span class="s2">&quot;test1&quot;</span><span class="p">,</span> <span class="n">config_path</span><span class="o">=</span><span class="n">handle</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42">    <span class="c1"># Basic query</span>
</span><span data-line="43">    <span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="44">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
</section>
<section id="profiling">
<h3>Profiling<a class="headerlink" href="#profiling" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id26">
<div class="code-block-caption"><span class="caption-text">last query profiling</span><a class="headerlink" href="#id26" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Profiling with and without details</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">json</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">sys</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="14">
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="17"><span class="p">)</span>
</span><span data-line="18">
</span><span data-line="19"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER SESSION SET QUERY_CACHE = &#39;OFF&#39;&quot;</span><span class="p">)</span>
</span><span data-line="20"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;ALTER SESSION SET PROFILE = &#39;ON&#39;&quot;</span><span class="p">)</span>
</span><span data-line="21">
</span><span data-line="22"><span class="c1"># Normal profiling</span>
</span><span data-line="23"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="24"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="25"><span class="sd">    SELECT u.user_id, sum(p.gross_amt) AS total_gross_amt</span>
</span><span data-line="26"><span class="sd">    FROM users u</span>
</span><span data-line="27"><span class="sd">        LEFT JOIN payments p ON (u.user_id=p.user_id)</span>
</span><span data-line="28"><span class="sd">    GROUP BY 1</span>
</span><span data-line="29"><span class="sd">    ORDER BY 2 DESC NULLS LAST</span>
</span><span data-line="30"><span class="sd">    LIMIT 10</span>
</span><span data-line="31"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="32"><span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="35"><span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">explain_last</span><span class="p">(),</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span><span data-line="36">
</span><span data-line="37"><span class="c1"># Profiling with extra details per node (IPROC column)</span>
</span><span data-line="38"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="39"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="40"><span class="sd">    SELECT u.user_id, sum(p.gross_amt) AS total_gross_amt</span>
</span><span data-line="41"><span class="sd">    FROM users u</span>
</span><span data-line="42"><span class="sd">        LEFT JOIN payments p ON (u.user_id=p.user_id)</span>
</span><span data-line="43"><span class="sd">    GROUP BY 1</span>
</span><span data-line="44"><span class="sd">    ORDER BY 2 DESC NULLS LAST</span>
</span><span data-line="45"><span class="sd">    LIMIT 10</span>
</span><span data-line="46"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="47"><span class="p">)</span>
</span><span data-line="48"><span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">explain_last</span><span class="p">(</span><span class="n">details</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="snapshot-transactions">
<h3>Snapshot Transactions<a class="headerlink" href="#snapshot-transactions" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id27">
<div class="code-block-caption"><span class="caption-text">snapshot transactions mode, which may help with metadata locking problems</span><a class="headerlink" href="#id27" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Snapshot transactions</span>
</span><span data-line="3"><span class="sd">Explanations about locks: https://exasol.my.site.com/s/article/WAIT-FOR-COMMIT-on-SELECT-statement?language=en_US</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># First connection, read first table, update second table</span>
</span><span data-line="15"><span class="n">C1</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="17"><span class="p">)</span>
</span><span data-line="18"><span class="n">C1</span><span class="o">.</span><span class="n">set_autocommit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="19">
</span><span data-line="20"><span class="n">C1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM TAB1&quot;</span><span class="p">)</span>
</span><span data-line="21"><span class="n">C1</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO TAB2 VALUES (1)&quot;</span><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="c1"># Second connection, update first table</span>
</span><span data-line="24"><span class="n">C2</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="25">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="26"><span class="p">)</span>
</span><span data-line="27"><span class="n">C2</span><span class="o">.</span><span class="n">set_autocommit</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span data-line="28">
</span><span data-line="29"><span class="n">C2</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;INSERT INTO TAB1 VALUES(1)&quot;</span><span class="p">)</span>
</span><span data-line="30"><span class="n">C2</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</span><span data-line="31">
</span><span data-line="32"><span class="c1"># Third connection, read second table</span>
</span><span data-line="33"><span class="n">C3</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="34">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="35">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="36">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="37">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="38">    <span class="n">snapshot_transactions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="39">    <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="40"><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42"><span class="c1"># Exasol locks on this query without snapshot transactions</span>
</span><span data-line="43"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C3</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="44">    <span class="s2">&quot;SELECT column_name, column_type FROM EXA_ALL_COLUMNS WHERE column_schema=CURRENT_SCHEMA AND column_table=&#39;TAB2&#39;&quot;</span>
</span><span data-line="45"><span class="p">)</span>
</span><span data-line="46"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span></pre></div>
</div>
</div>
</section>
<section id="udf-script-output">
<h3>UDF Script Output<a class="headerlink" href="#udf-script-output" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id28">
<div class="code-block-caption"><span class="caption-text">run query with UDF script and capture output (may not work on a local laptop)</span><a class="headerlink" href="#id28" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Script output server</span>
</span><span data-line="3"><span class="sd">Exasol should be able to open connection to the host where current script is running</span>
</span><span data-line="4"><span class="sd">May not work on laptops due to firewall and network security restrictions</span>
</span><span data-line="5"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">os</span>
</span><span data-line="8"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="11">
</span><span data-line="12"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="13">
</span><span data-line="14"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="15">
</span><span data-line="16"><span class="n">is_travis</span> <span class="o">=</span> <span class="s2">&quot;TRAVIS&quot;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span>
</span><span data-line="17">
</span><span data-line="18"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="19">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="21">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="22">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="23">    <span class="n">query_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
</span><span data-line="24">    <span class="c1"># Custom parameters are required to make this example work in Travis context</span>
</span><span data-line="25">    <span class="c1"># 172.17.0.1 is an IP address of docker host in Linux</span>
</span><span data-line="26">    <span class="n">udf_output_bind_address</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="mi">8580</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_travis</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="27">    <span class="n">udf_output_connect_address</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;172.17.0.1&quot;</span><span class="p">,</span> <span class="mi">8580</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_travis</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="28"><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30"><span class="c1"># Normal script output from multiple VM&#39;s</span>
</span><span data-line="31"><span class="n">stmt</span><span class="p">,</span> <span class="n">log_files</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute_udf_output</span><span class="p">(</span>
</span><span data-line="32"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="33"><span class="sd">    SELECT echo_java(user_id)</span>
</span><span data-line="34"><span class="sd">    FROM users</span>
</span><span data-line="35"><span class="sd">    GROUP BY CEIL(RANDOM() * 4)</span>
</span><span data-line="36"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="37"><span class="p">)</span>
</span><span data-line="38">
</span><span data-line="39"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="40"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">log_files</span><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42"><span class="nb">print</span><span class="p">(</span><span class="n">log_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">read_text</span><span class="p">())</span>
</span><span data-line="43">
</span><span data-line="44"><span class="c1"># No rows selected, no VM&#39;s started by Exasol, no log files created</span>
</span><span data-line="45"><span class="c1"># execute_udf_output should not hang in such case</span>
</span><span data-line="46"><span class="n">stmt</span><span class="p">,</span> <span class="n">log_files</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute_udf_output</span><span class="p">(</span>
</span><span data-line="47"><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="48"><span class="sd">    WITH cte_users AS (</span>
</span><span data-line="49"><span class="sd">        SELECT user_id</span>
</span><span data-line="50"><span class="sd">        FROM users</span>
</span><span data-line="51"><span class="sd">        ORDER BY null</span>
</span><span data-line="52"><span class="sd">        LIMIT 0</span>
</span><span data-line="53"><span class="sd">    )</span>
</span><span data-line="54"><span class="sd">    SELECT echo_java(user_id)</span>
</span><span data-line="55"><span class="sd">    FROM cte_users</span>
</span><span data-line="56"><span class="sd">    GROUP BY CEIL(RANDOM() * 4)</span>
</span><span data-line="57"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="58"><span class="p">)</span>
</span><span data-line="59">
</span><span data-line="60"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="61"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">log_files</span><span class="p">)</span>
</span><span data-line="62">
</span><span data-line="63"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SELECTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="class-extension">
<h3>Class Extension<a class="headerlink" href="#class-extension" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id29">
<div class="code-block-caption"><span class="caption-text">extend core PyEXASOL classes to add custom logic</span><a class="headerlink" href="#id29" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Extend core PyEXASOL classes, add custom logic</span>
</span><span data-line="3"><span class="sd">In this example we add print_session_id() custom method to all objects</span>
</span><span data-line="4"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="5">
</span><span data-line="6"><span class="kn">import</span> <span class="nn">collections</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="14">
</span><span data-line="15">
</span><span data-line="16"><span class="k">class</span> <span class="nc">CustomExaStatement</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaStatement</span><span class="p">):</span>
</span><span data-line="17">    <span class="k">def</span> <span class="nf">print_session_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="18">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Statement session_id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="19">
</span><span data-line="20">
</span><span data-line="21"><span class="k">class</span> <span class="nc">CustomExaFormatter</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaFormatter</span><span class="p">):</span>
</span><span data-line="22">    <span class="k">def</span> <span class="nf">print_session_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="23">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Formatter session_id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="24">
</span><span data-line="25">
</span><span data-line="26"><span class="k">class</span> <span class="nc">CustomExaLogger</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaLogger</span><span class="p">):</span>
</span><span data-line="27">    <span class="k">def</span> <span class="nf">print_session_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="28">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Logger session_id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="k">class</span> <span class="nc">CustomExaExtension</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaExtension</span><span class="p">):</span>
</span><span data-line="32">    <span class="k">def</span> <span class="nf">print_session_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="33">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Extension session_id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="34">
</span><span data-line="35">
</span><span data-line="36"><span class="k">class</span> <span class="nc">CustomExaMetaData</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaMetaData</span><span class="p">):</span>
</span><span data-line="37">    <span class="k">def</span> <span class="nf">print_session_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="38">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MetaData session_id: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40">
</span><span data-line="41"><span class="k">class</span> <span class="nc">CustomExaConnection</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnection</span><span class="p">):</span>
</span><span data-line="42">    <span class="c1"># Set custom sub-classes here</span>
</span><span data-line="43">    <span class="n">cls_statement</span> <span class="o">=</span> <span class="n">CustomExaStatement</span>
</span><span data-line="44">    <span class="n">cls_formatter</span> <span class="o">=</span> <span class="n">CustomExaFormatter</span>
</span><span data-line="45">    <span class="n">cls_logger</span> <span class="o">=</span> <span class="n">CustomExaLogger</span>
</span><span data-line="46">    <span class="n">cls_extension</span> <span class="o">=</span> <span class="n">CustomExaExtension</span>
</span><span data-line="47">    <span class="n">cls_meta</span> <span class="o">=</span> <span class="n">CustomExaMetaData</span>
</span><span data-line="48">
</span><span data-line="49">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span data-line="50">        <span class="k">if</span> <span class="s2">&quot;custom_param&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
</span><span data-line="51">            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Custom connection parameter: </span><span class="si">{</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;custom_param&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span data-line="52">            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;custom_param&quot;</span><span class="p">]</span>
</span><span data-line="53">
</span><span data-line="54">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span data-line="55">
</span><span data-line="56">
</span><span data-line="57"><span class="n">C</span> <span class="o">=</span> <span class="n">CustomExaConnection</span><span class="p">(</span>
</span><span data-line="58">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="59">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="60">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="61">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="62">    <span class="n">custom_param</span><span class="o">=</span><span class="s2">&quot;test custom param!&quot;</span><span class="p">,</span>
</span><span data-line="63"><span class="p">)</span>
</span><span data-line="64">
</span><span data-line="65"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="66">
</span><span data-line="67"><span class="c1"># Access overloaded objects</span>
</span><span data-line="68"><span class="n">stmt</span><span class="o">.</span><span class="n">print_session_id</span><span class="p">()</span>
</span><span data-line="69"><span class="n">C</span><span class="o">.</span><span class="n">format</span><span class="o">.</span><span class="n">print_session_id</span><span class="p">()</span>
</span><span data-line="70"><span class="n">C</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">print_session_id</span><span class="p">()</span>
</span><span data-line="71"><span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">print_session_id</span><span class="p">()</span>
</span><span data-line="72"><span class="n">C</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">print_session_id</span><span class="p">()</span>
</span><span data-line="73">
</span><span data-line="74"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="75">
</span><span data-line="76"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Return result rows as named tuples&quot;</span><span class="p">)</span>
</span><span data-line="77">
</span><span data-line="78">
</span><span data-line="79"><span class="k">class</span> <span class="nc">NamedTupleExaStatement</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaStatement</span><span class="p">):</span>
</span><span data-line="80">    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="81">        <span class="n">row</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>
</span><span data-line="82">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls_row</span><span class="p">(</span><span class="o">*</span><span class="n">row</span><span class="p">)</span>
</span><span data-line="83">
</span><span data-line="84">    <span class="k">def</span> <span class="nf">_init_result_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">res</span><span class="p">):</span>
</span><span data-line="85">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_init_result_set</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span><span data-line="86">        <span class="bp">self</span><span class="o">.</span><span class="n">cls_row</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Row&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">col_names</span><span class="p">)</span>
</span><span data-line="87">
</span><span data-line="88">
</span><span data-line="89"><span class="k">class</span> <span class="nc">NamedTupleExaConnection</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnection</span><span class="p">):</span>
</span><span data-line="90">    <span class="n">cls_statement</span> <span class="o">=</span> <span class="n">NamedTupleExaStatement</span>
</span><span data-line="91">
</span><span data-line="92">
</span><span data-line="93"><span class="n">C</span> <span class="o">=</span> <span class="n">NamedTupleExaConnection</span><span class="p">(</span>
</span><span data-line="94">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="95"><span class="p">)</span>
</span><span data-line="96"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="97"><span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">())</span>
</span><span data-line="98"><span class="nb">print</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchone</span><span class="p">())</span>
</span><span data-line="99">
</span><span data-line="100"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="quoted-identifiers">
<h3>Quoted Identifiers<a class="headerlink" href="#quoted-identifiers" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id30">
<div class="code-block-caption"><span class="caption-text">enable quoted identifiers for import_*, export_* and other relevant functions</span><a class="headerlink" href="#id30" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Major cases when &#39;quote_ident&#39; connection option takes effect</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13"><span class="c1"># Basic connect</span>
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">quote_ident</span><span class="o">=</span><span class="kc">True</span>
</span><span data-line="16"><span class="p">)</span>
</span><span data-line="17">
</span><span data-line="18"><span class="c1"># Open schema</span>
</span><span data-line="19"><span class="n">C</span><span class="o">.</span><span class="n">open_schema</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">)</span>
</span><span data-line="20">
</span><span data-line="21"><span class="c1"># Export from table name with lower case characters</span>
</span><span data-line="22"><span class="n">pd</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">export_to_pandas</span><span class="p">(</span><span class="s2">&quot;camelCaseTable&quot;</span><span class="p">)</span>
</span><span data-line="23"><span class="n">pd</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</span><span data-line="24">
</span><span data-line="25"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="26"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EXPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="27">
</span><span data-line="28"><span class="c1"># Export into table name with lower case characters</span>
</span><span data-line="29"><span class="n">C</span><span class="o">.</span><span class="n">import_from_pandas</span><span class="p">(</span><span class="n">pd</span><span class="p">,</span> <span class="s2">&quot;camelCaseTable&quot;</span><span class="p">)</span>
</span><span data-line="30">
</span><span data-line="31"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">last_statement</span><span class="p">()</span>
</span><span data-line="32"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMPORTED </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">rowcount</span><span class="p">()</span><span class="si">}</span><span class="s2"> rows in </span><span class="si">{</span><span class="n">stmt</span><span class="o">.</span><span class="n">execution_time</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
</span><span data-line="33">
</span><span data-line="34"><span class="c1"># Ext</span>
</span><span data-line="35"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_columns</span><span class="p">(</span><span class="s2">&quot;camelCaseTable&quot;</span><span class="p">)</span>
</span><span data-line="36"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span data-line="37">
</span><span data-line="38"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_columns_sql</span><span class="p">(</span>
</span><span data-line="39">    <span class="s2">&quot;SELECT * FROM {table_name!q}&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;camelCaseTable&quot;</span><span class="p">}</span>
</span><span data-line="40"><span class="p">)</span>
</span><span data-line="41"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span data-line="42">
</span><span data-line="43"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_columns</span><span class="p">((</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span> <span class="s2">&quot;camelCaseTable&quot;</span><span class="p">))</span>
</span><span data-line="44"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span><span data-line="45">
</span><span data-line="46"><span class="n">cols</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">get_sys_columns</span><span class="p">(</span><span class="s2">&quot;camelCaseTable&quot;</span><span class="p">)</span>
</span><span data-line="47"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="thread-safety">
<h3>Thread Safety<a class="headerlink" href="#thread-safety" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id31">
<div class="code-block-caption"><span class="caption-text">built-in protection from accessing connection object from multiple threads simultaneously</span><a class="headerlink" href="#id31" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Attempt to access connection object from multiple threads simultaneously</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">threading</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">time</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="14">
</span><span data-line="15">
</span><span data-line="16"><span class="k">class</span> <span class="nc">QueryThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
</span><span data-line="17">    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">):</span>
</span><span data-line="18">        <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span>
</span><span data-line="19">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
</span><span data-line="20">
</span><span data-line="21">    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="22">        <span class="c1"># Run heavy query</span>
</span><span data-line="23">        <span class="k">try</span><span class="p">:</span>
</span><span data-line="24">            <span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
</span><span data-line="25">                <span class="s2">&quot;SELECT * FROM users a, users b, users c, payments d&quot;</span>
</span><span data-line="26">            <span class="p">)</span>
</span><span data-line="27">        <span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaQueryAbortError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="28">            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</span><span data-line="29">        <span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConcurrencyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="30">            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
</span><span data-line="31">
</span><span data-line="32">
</span><span data-line="33"><span class="c1"># Basic connect</span>
</span><span data-line="34"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="35">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span> <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span>
</span><span data-line="36"><span class="p">)</span>
</span><span data-line="37">
</span><span data-line="38"><span class="c1"># Try to run multiple query threads in parallel</span>
</span><span data-line="39"><span class="n">query_thread_1</span> <span class="o">=</span> <span class="n">QueryThread</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</span><span data-line="40"><span class="n">query_thread_2</span> <span class="o">=</span> <span class="n">QueryThread</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42"><span class="n">query_thread_1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="43"><span class="n">query_thread_2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span data-line="44">
</span><span data-line="45"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="46"><span class="n">C</span><span class="o">.</span><span class="n">abort_query</span><span class="p">()</span>
</span><span data-line="47">
</span><span data-line="48"><span class="n">query_thread_1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span data-line="49"><span class="n">query_thread_2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="dsn-parsing">
<h3>DSN Parsing<a class="headerlink" href="#dsn-parsing" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id32">
<div class="code-block-caption"><span class="caption-text">parsing of complex connection strings and catching relevant exceptions</span><a class="headerlink" href="#id32" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Demonstration of DSN (Connection string) expansion and related exceptions</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6">
</span><span data-line="7"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="10">
</span><span data-line="11"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="12">
</span><span data-line="13">
</span><span data-line="14"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="15">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="16">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">verbose_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">encryption</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IP range with custom port: &quot;</span><span class="p">)</span>
</span><span data-line="24"><span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot;127.0.0.10..19:8564&quot;</span><span class="p">)</span>
</span><span data-line="25"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span><span data-line="26">
</span><span data-line="27"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple ranges with multiple ports and with default port at the end: &quot;</span><span class="p">)</span>
</span><span data-line="28"><span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot;127.0.0.10..19:8564,127.0.0.20,localhost:8565,127.0.0.21..23&quot;</span><span class="p">)</span>
</span><span data-line="29"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span><span data-line="30">
</span><span data-line="31"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Multiple ranges with fingerprint and port: &quot;</span><span class="p">)</span>
</span><span data-line="32"><span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot;127.0.0.10..19/ABC,127.0.0.20,localhost/CDE:8564&quot;</span><span class="p">)</span>
</span><span data-line="33"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</span><span data-line="34">
</span><span data-line="35"><span class="c1"># Empty DSN</span>
</span><span data-line="36"><span class="k">try</span><span class="p">:</span>
</span><span data-line="37">    <span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
</span><span data-line="38">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span data-line="39"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionDsnError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="40">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="41">
</span><span data-line="42">
</span><span data-line="43"><span class="c1"># Invalid range</span>
</span><span data-line="44"><span class="k">try</span><span class="p">:</span>
</span><span data-line="45">    <span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot;127.0.0.15..10&quot;</span><span class="p">)</span>
</span><span data-line="46">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span data-line="47"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionDsnError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="48">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="49">
</span><span data-line="50"><span class="c1"># Cannot resolve hostname</span>
</span><span data-line="51"><span class="k">try</span><span class="p">:</span>
</span><span data-line="52">    <span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot;test1..5.zlan&quot;</span><span class="p">)</span>
</span><span data-line="53">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span data-line="54"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionDsnError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="55">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span data-line="56">
</span><span data-line="57"><span class="c1"># Hostname range with zero-padding</span>
</span><span data-line="58"><span class="k">try</span><span class="p">:</span>
</span><span data-line="59">    <span class="n">result</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">_process_dsn</span><span class="p">(</span><span class="s2">&quot;test01..20.zlan&quot;</span><span class="p">)</span>
</span><span data-line="60">    <span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span data-line="61"><span class="k">except</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnectionDsnError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span data-line="62">    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
<section id="http-proxy">
<h3>HTTP Proxy<a class="headerlink" href="#http-proxy" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id33">
<div class="code-block-caption"><span class="caption-text">connection via HTTP proxy</span><a class="headerlink" href="#id33" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Open connection with HTTP proxy</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">subprocess</span>
</span><span data-line="7"><span class="kn">import</span> <span class="nn">time</span>
</span><span data-line="8">
</span><span data-line="9"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="10">
</span><span data-line="11"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="12">
</span><span data-line="13"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="14">
</span><span data-line="15"><span class="c1"># Simple HTTP proxy</span>
</span><span data-line="16"><span class="n">pproxy</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="s2">&quot;pproxy&quot;</span><span class="p">,</span> <span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;http://:8562/&quot;</span><span class="p">,</span> <span class="s2">&quot;--reuse&quot;</span><span class="p">])</span>
</span><span data-line="17"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="18">
</span><span data-line="19"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="20">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="21">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="22">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="23">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="24">    <span class="n">http_proxy</span><span class="o">=</span><span class="s2">&quot;http://localhost:8562&quot;</span><span class="p">,</span>
</span><span data-line="25"><span class="p">)</span>
</span><span data-line="26">
</span><span data-line="27"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="28"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="29">
</span><span data-line="30"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="31"><span class="n">pproxy</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span data-line="32">
</span><span data-line="33">
</span><span data-line="34"><span class="c1"># HTTP proxy with auth</span>
</span><span data-line="35"><span class="n">pproxy</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span data-line="36">    <span class="p">[</span><span class="s2">&quot;pproxy&quot;</span><span class="p">,</span> <span class="s2">&quot;-l&quot;</span><span class="p">,</span> <span class="s2">&quot;http://:8562/#my_user:secret_pass&quot;</span><span class="p">,</span> <span class="s2">&quot;--reuse&quot;</span><span class="p">]</span>
</span><span data-line="37"><span class="p">)</span>
</span><span data-line="38"><span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span data-line="39">
</span><span data-line="40"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="41">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="42">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="43">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="44">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="45">    <span class="n">http_proxy</span><span class="o">=</span><span class="s2">&quot;http://my_user:secret_pass@localhost:8562&quot;</span><span class="p">,</span>
</span><span data-line="46"><span class="p">)</span>
</span><span data-line="47">
</span><span data-line="48"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users ORDER BY user_id LIMIT 5&quot;</span><span class="p">)</span>
</span><span data-line="49"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="50">
</span><span data-line="51"><span class="n">C</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span><span data-line="52"><span class="n">pproxy</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="garbage-collection">
<h3>Garbage Collection<a class="headerlink" href="#garbage-collection" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id34">
<div class="code-block-caption"><span class="caption-text">detect potential garbage collection problems due to cross-references</span><a class="headerlink" href="#id34" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">Ensure ExaConnection and ExaStatement objects are garbage collected properly</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">gc</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14">
</span><span data-line="15"><span class="k">class</span> <span class="nc">ExaStatementVerbose</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaStatement</span><span class="p">):</span>
</span><span data-line="16">    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="17">        <span class="nb">print</span><span class="p">(</span>
</span><span data-line="18">            <span class="sa">f</span><span class="s2">&quot;ExaStatement session_id=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2">, stmt_idx=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">stmt_idx</span><span class="si">}</span><span class="s2"> is about to be collected&quot;</span>
</span><span data-line="19">        <span class="p">)</span>
</span><span data-line="20">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__del__</span><span class="p">()</span>
</span><span data-line="21">
</span><span data-line="22">
</span><span data-line="23"><span class="k">class</span> <span class="nc">ExaConnectionVerbose</span><span class="p">(</span><span class="n">pyexasol</span><span class="o">.</span><span class="n">ExaConnection</span><span class="p">):</span>
</span><span data-line="24">    <span class="n">cls_statement</span> <span class="o">=</span> <span class="n">ExaStatementVerbose</span>
</span><span data-line="25">
</span><span data-line="26">    <span class="k">def</span> <span class="fm">__del__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span data-line="27">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ExaConnection </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">session_id</span><span class="p">()</span><span class="si">}</span><span class="s2"> is about to be collected&quot;</span><span class="p">)</span>
</span><span data-line="28">        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__del__</span><span class="p">()</span>
</span><span data-line="29">
</span><span data-line="30">
</span><span data-line="31"><span class="k">def</span> <span class="nf">run_test</span><span class="p">():</span>
</span><span data-line="32">    <span class="n">C</span> <span class="o">=</span> <span class="n">ExaConnectionVerbose</span><span class="p">(</span>
</span><span data-line="33">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="34">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="35">        <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="36">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="37">        <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="38">        <span class="n">fetch_size_bytes</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
</span><span data-line="39">    <span class="p">)</span>
</span><span data-line="40">
</span><span data-line="41">    <span class="c1"># Execute statement, read some data</span>
</span><span data-line="42">    <span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users&quot;</span><span class="p">)</span>
</span><span data-line="43">    <span class="n">st</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span data-line="44">
</span><span data-line="45">    <span class="c1"># Execute another statement, no more references for the first statement</span>
</span><span data-line="46">    <span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM payments&quot;</span><span class="p">)</span>
</span><span data-line="47">    <span class="n">st</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span data-line="48">
</span><span data-line="49">    <span class="k">del</span> <span class="n">st</span>
</span><span data-line="50">    <span class="k">del</span> <span class="n">C</span>
</span><span data-line="51">
</span><span data-line="52">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Collect call 1 start&quot;</span><span class="p">)</span>
</span><span data-line="53">    <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span data-line="54">    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Collect call 1 finish&quot;</span><span class="p">)</span>
</span><span data-line="55">
</span><span data-line="56">    <span class="n">C</span> <span class="o">=</span> <span class="n">ExaConnectionVerbose</span><span class="p">(</span>
</span><span data-line="57">        <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="58">        <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="59">        <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="60">        <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="61">        <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span data-line="62">        <span class="n">fetch_size_bytes</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span>
</span><span data-line="63">    <span class="p">)</span>
</span><span data-line="64">
</span><span data-line="65">    <span class="n">st</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users&quot;</span><span class="p">)</span>
</span><span data-line="66">    <span class="n">st</span><span class="o">.</span><span class="n">fetchmany</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span><span data-line="67">
</span><span data-line="68">
</span><span data-line="69"><span class="n">run_test</span><span class="p">()</span>
</span><span data-line="70">
</span><span data-line="71"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Collect call 2 start&quot;</span><span class="p">)</span>
</span><span data-line="72"><span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()</span>
</span><span data-line="73"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Collect call 2 finish&quot;</span><span class="p">)</span>
</span><span data-line="74">
</span><span data-line="75"><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finishing script, nothing should be collected beyond this point!&quot;</span><span class="p">)</span>
</span></pre></div>
</div>
</div>
</section>
</section>
<section id="examples-of-json-libraries-used-for-fetching">
<h2>Examples of JSON libraries used for fetching<a class="headerlink" href="#examples-of-json-libraries-used-for-fetching" title="Link to this heading">¶</a></h2>
<section id="rapidjson">
<h3>RapidJSON<a class="headerlink" href="#rapidjson" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id35">
<div class="code-block-caption"><span class="caption-text">JSON library rapidjson</span><a class="headerlink" href="#id35" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">JSON library &quot;rapidjson&quot;</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">decimal</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Basic connect</span>
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">json_lib</span><span class="o">=</span><span class="s2">&quot;rapidjson&quot;</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="n">edge_cases</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="24">    <span class="c1"># Biggest values</span>
</span><span data-line="25">    <span class="p">{</span>
</span><span data-line="26">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="27">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="28">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="29">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="30">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31&quot;</span><span class="p">,</span>
</span><span data-line="31">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31 23:59:59.999&quot;</span><span class="p">,</span>
</span><span data-line="32">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="33">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">2000000</span><span class="p">,</span>
</span><span data-line="34">    <span class="p">},</span>
</span><span data-line="35">    <span class="c1"># Smallest values</span>
</span><span data-line="36">    <span class="p">{</span>
</span><span data-line="37">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="38">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="39">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="40">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="41">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01&quot;</span><span class="p">,</span>
</span><span data-line="42">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01 00:00:00&quot;</span><span class="p">,</span>
</span><span data-line="43">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span data-line="44">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span><span class="p">,</span>
</span><span data-line="45">    <span class="p">},</span>
</span><span data-line="46">    <span class="c1"># All nulls</span>
</span><span data-line="47">    <span class="p">{</span>
</span><span data-line="48">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="49">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="50">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="51">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="52">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="53">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="54">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="55">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="56">    <span class="p">},</span>
</span><span data-line="57"><span class="p">]</span>
</span><span data-line="58">
</span><span data-line="59"><span class="n">insert_q</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO edge_case VALUES ({dec36_0!d}, {dec36_36!d}, {dbl!f}, </span><span class="si">{bl}</span><span class="s2">, </span><span class="si">{dt}</span><span class="s2">, </span><span class="si">{ts}</span><span class="s2">, </span><span class="si">{var100}</span><span class="s2">, </span><span class="si">{var2000000}</span><span class="s2">)&quot;</span>
</span><span data-line="60"><span class="n">select_q</span> <span class="o">=</span> <span class="s2">&quot;SELECT dec36_0, dec36_36, dbl, bl, dt, ts, var100, LENGTH(var2000000) AS len_var FROM edge_case&quot;</span>
</span><span data-line="61">
</span><span data-line="62"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="63">
</span><span data-line="64"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="65"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="66"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="67"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="68">
</span><span data-line="69"><span class="c1"># Select and fetch</span>
</span><span data-line="70"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="71"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="72">
</span><span data-line="73">
</span><span data-line="74"><span class="c1"># Same actions with &quot;exasol_mapper&quot;</span>
</span><span data-line="75"><span class="n">C</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;fetch_mapper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">exasol_mapper</span>
</span><span data-line="76"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="77">
</span><span data-line="78"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="79"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="80"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="81"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="82">
</span><span data-line="83"><span class="c1"># Select and fetch</span>
</span><span data-line="84"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="85"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="86">
</span><span data-line="87"><span class="c1"># Import and export</span>
</span><span data-line="88"><span class="n">edge_tuples</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM edge_case&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="ujson">
<h3>UJSON<a class="headerlink" href="#ujson" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id36">
<div class="code-block-caption"><span class="caption-text">JSON library ujson</span><a class="headerlink" href="#id36" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">JSON library &quot;ujson&quot;</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">decimal</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Basic connect</span>
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">json_lib</span><span class="o">=</span><span class="s2">&quot;ujson&quot;</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="n">edge_cases</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="24">    <span class="c1"># Biggest values</span>
</span><span data-line="25">    <span class="p">{</span>
</span><span data-line="26">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="27">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="28">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="29">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="30">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31&quot;</span><span class="p">,</span>
</span><span data-line="31">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31 23:59:59.999&quot;</span><span class="p">,</span>
</span><span data-line="32">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="33">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">2000000</span><span class="p">,</span>
</span><span data-line="34">    <span class="p">},</span>
</span><span data-line="35">    <span class="c1"># Smallest values</span>
</span><span data-line="36">    <span class="p">{</span>
</span><span data-line="37">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="38">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="39">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="40">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="41">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01&quot;</span><span class="p">,</span>
</span><span data-line="42">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01 00:00:00&quot;</span><span class="p">,</span>
</span><span data-line="43">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span data-line="44">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span><span class="p">,</span>
</span><span data-line="45">    <span class="p">},</span>
</span><span data-line="46">    <span class="c1"># All nulls</span>
</span><span data-line="47">    <span class="p">{</span>
</span><span data-line="48">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="49">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="50">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="51">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="52">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="53">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="54">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="55">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="56">    <span class="p">},</span>
</span><span data-line="57"><span class="p">]</span>
</span><span data-line="58">
</span><span data-line="59"><span class="n">insert_q</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO edge_case VALUES ({dec36_0!d}, {dec36_36!d}, {dbl!f}, </span><span class="si">{bl}</span><span class="s2">, </span><span class="si">{dt}</span><span class="s2">, </span><span class="si">{ts}</span><span class="s2">, </span><span class="si">{var100}</span><span class="s2">, </span><span class="si">{var2000000}</span><span class="s2">)&quot;</span>
</span><span data-line="60"><span class="n">select_q</span> <span class="o">=</span> <span class="s2">&quot;SELECT dec36_0, dec36_36, dbl, bl, dt, ts, var100, LENGTH(var2000000) AS len_var FROM edge_case&quot;</span>
</span><span data-line="61">
</span><span data-line="62"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="63">
</span><span data-line="64"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="65"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="66"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="67"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="68">
</span><span data-line="69"><span class="c1"># Select and fetch</span>
</span><span data-line="70"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="71"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="72">
</span><span data-line="73">
</span><span data-line="74"><span class="c1"># Same actions with &quot;exasol_mapper&quot;</span>
</span><span data-line="75"><span class="n">C</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;fetch_mapper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">exasol_mapper</span>
</span><span data-line="76"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="77">
</span><span data-line="78"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="79"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="80"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="81"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="82">
</span><span data-line="83"><span class="c1"># Select and fetch</span>
</span><span data-line="84"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="85"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="86">
</span><span data-line="87"><span class="c1"># Import and export</span>
</span><span data-line="88"><span class="n">edge_tuples</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM edge_case&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
<section id="orjson">
<h3>ORJSON<a class="headerlink" href="#orjson" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id37">
<div class="code-block-caption"><span class="caption-text">JSON library orjson</span><a class="headerlink" href="#id37" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span data-line="1"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="2"><span class="sd">JSON library &quot;orjson&quot;</span>
</span><span data-line="3"><span class="sd">&quot;&quot;&quot;</span>
</span><span data-line="4">
</span><span data-line="5"><span class="kn">import</span> <span class="nn">decimal</span>
</span><span data-line="6"><span class="kn">import</span> <span class="nn">pprint</span>
</span><span data-line="7">
</span><span data-line="8"><span class="kn">import</span> <span class="nn">_config</span> <span class="k">as</span> <span class="nn">config</span>
</span><span data-line="9">
</span><span data-line="10"><span class="kn">import</span> <span class="nn">pyexasol</span>
</span><span data-line="11">
</span><span data-line="12"><span class="n">printer</span> <span class="o">=</span> <span class="n">pprint</span><span class="o">.</span><span class="n">PrettyPrinter</span><span class="p">(</span><span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">140</span><span class="p">)</span>
</span><span data-line="13">
</span><span data-line="14"><span class="c1"># Basic connect</span>
</span><span data-line="15"><span class="n">C</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
</span><span data-line="16">    <span class="n">dsn</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">dsn</span><span class="p">,</span>
</span><span data-line="17">    <span class="n">user</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">user</span><span class="p">,</span>
</span><span data-line="18">    <span class="n">password</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
</span><span data-line="19">    <span class="n">schema</span><span class="o">=</span><span class="n">config</span><span class="o">.</span><span class="n">schema</span><span class="p">,</span>
</span><span data-line="20">    <span class="n">json_lib</span><span class="o">=</span><span class="s2">&quot;orjson&quot;</span><span class="p">,</span>
</span><span data-line="21"><span class="p">)</span>
</span><span data-line="22">
</span><span data-line="23"><span class="n">edge_cases</span> <span class="o">=</span> <span class="p">[</span>
</span><span data-line="24">    <span class="c1"># Biggest values</span>
</span><span data-line="25">    <span class="p">{</span>
</span><span data-line="26">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="27">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;+0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="28">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="29">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
</span><span data-line="30">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31&quot;</span><span class="p">,</span>
</span><span data-line="31">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;9999-12-31 23:59:59.999&quot;</span><span class="p">,</span>
</span><span data-line="32">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span>
</span><span data-line="33">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span> <span class="o">*</span> <span class="mi">2000000</span><span class="p">,</span>
</span><span data-line="34">    <span class="p">},</span>
</span><span data-line="35">    <span class="c1"># Smallest values</span>
</span><span data-line="36">    <span class="p">{</span>
</span><span data-line="37">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="38">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="n">decimal</span><span class="o">.</span><span class="n">Decimal</span><span class="p">(</span><span class="s2">&quot;-0.&quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;9&quot;</span> <span class="o">*</span> <span class="mi">36</span><span class="p">)),</span>
</span><span data-line="39">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.7e308</span><span class="p">,</span>
</span><span data-line="40">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
</span><span data-line="41">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01&quot;</span><span class="p">,</span>
</span><span data-line="42">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01 00:00:00&quot;</span><span class="p">,</span>
</span><span data-line="43">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span data-line="44">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="s2">&quot;ひ&quot;</span><span class="p">,</span>
</span><span data-line="45">    <span class="p">},</span>
</span><span data-line="46">    <span class="c1"># All nulls</span>
</span><span data-line="47">    <span class="p">{</span>
</span><span data-line="48">        <span class="s2">&quot;dec36_0&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="49">        <span class="s2">&quot;dec36_36&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="50">        <span class="s2">&quot;dbl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="51">        <span class="s2">&quot;bl&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="52">        <span class="s2">&quot;dt&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="53">        <span class="s2">&quot;ts&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="54">        <span class="s2">&quot;var100&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="55">        <span class="s2">&quot;var2000000&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
</span><span data-line="56">    <span class="p">},</span>
</span><span data-line="57"><span class="p">]</span>
</span><span data-line="58">
</span><span data-line="59"><span class="n">insert_q</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO edge_case VALUES ({dec36_0!d}, {dec36_36!d}, {dbl!f}, </span><span class="si">{bl}</span><span class="s2">, </span><span class="si">{dt}</span><span class="s2">, </span><span class="si">{ts}</span><span class="s2">, </span><span class="si">{var100}</span><span class="s2">, </span><span class="si">{var2000000}</span><span class="s2">)&quot;</span>
</span><span data-line="60"><span class="n">select_q</span> <span class="o">=</span> <span class="s2">&quot;SELECT dec36_0, dec36_36, dbl, bl, dt, ts, var100, LENGTH(var2000000) AS len_var FROM edge_case&quot;</span>
</span><span data-line="61">
</span><span data-line="62"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="63">
</span><span data-line="64"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="65"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="66"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="67"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="68">
</span><span data-line="69"><span class="c1"># Select and fetch</span>
</span><span data-line="70"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="71"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="72">
</span><span data-line="73">
</span><span data-line="74"><span class="c1"># Same actions with &quot;exasol_mapper&quot;</span>
</span><span data-line="75"><span class="n">C</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;fetch_mapper&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pyexasol</span><span class="o">.</span><span class="n">exasol_mapper</span>
</span><span data-line="76"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;TRUNCATE TABLE edge_case&quot;</span><span class="p">)</span>
</span><span data-line="77">
</span><span data-line="78"><span class="c1"># Insert (test formatting)</span>
</span><span data-line="79"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</span><span data-line="80"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</span><span data-line="81"><span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">insert_q</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">edge_cases</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</span><span data-line="82">
</span><span data-line="83"><span class="c1"># Select and fetch</span>
</span><span data-line="84"><span class="n">stmt</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">select_q</span><span class="p">)</span>
</span><span data-line="85"><span class="n">printer</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">stmt</span><span class="o">.</span><span class="n">fetchall</span><span class="p">())</span>
</span><span data-line="86">
</span><span data-line="87"><span class="c1"># Import and export</span>
</span><span data-line="88"><span class="n">edge_tuples</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM edge_case&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
</span></pre></div>
</div>
</div>
</section>
</section>
</section>

        </article><button class="back-to-top" type="button">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
  </svg>
  <span>Back to top</span>
</button><div class="navigation flex print:hidden"><div class="navigation-prev">
    <a href="best_practices.html">
      <i class="i-lucide chevron-left"></i>
      <div class="page-info">
        <span>Previous</span><div class="title">Best Practices</div></div>
    </a>
  </div><div class="navigation-next">
    <a href="encryption.html">
      <div class="page-info">
        <span>Next</span>
        <div class="title">Encryption</div>
      </div>
      <i class="i-lucide chevron-right"></i>
    </a>
  </div></div></div>
    </div>
  </main>
</div>
<footer class="sy-foot">
  <div class="sy-foot-inner sy-container mx-auto">
    <div class="sy-foot-reserved md:flex justify-between items-center">
      <div class="sy-foot-copyright"><p>2024, Exasol</p>
  
  <p>
    Made with
    
    <a href="https://www.sphinx-doc.org/">Sphinx</a> and
    
    <a href="https://shibuya.lepture.com">Shibuya theme</a>.
  </p>
</div>
      <div class="sy-foot-socials">
<a href="https://github.com/exasol/pyexasol" aria-label="GitHub">
  <iconify-icon icon="simple-icons:github"></iconify-icon>
</a></div>
    </div>
  </div>
</footer>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../_static/copybutton.js?v=f281be69"></script>
      <script src="../_static/design-tabs.js?v=f930bc37"></script>
      <script src="../_static/shibuya.js?v=e2e99575"></script></body>
</html>